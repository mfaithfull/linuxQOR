// Copyright Querysoft Limited 2008 - 2025
//
// Permission is hereby granted, free of charge, to any person or organization
// obtaining a copy of the software and accompanying documentation covered by
// this license (the "Software") to use, reproduce, display, distribute,
// execute, and transmit the Software, and to prepare derivative works of the
// Software, and to permit third-parties to whom the Software is furnished to
// do so, all subject to the following:
// 
// The copyright notices in the Software and this entire statement, including
// the above license grant, this restriction and the following disclaimer,
// must be included in all copies of the Software, in whole or in part, and
// all derivative works of the Software, unless such copies or derivative
// works are solely in the form of machine-executable object code generated by
// a source language processor.
// 
// THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
// IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
// FITNESS FOR A PARTICULAR PURPOSE, TITLE AND NON-INFRINGEMENT. IN NO EVENT
// SHALL THE COPYRIGHT HOLDERS OR ANYONE DISTRIBUTING THE SOFTWARE BE LIABLE
// FOR ANY DAMAGES OR OTHER LIABILITY, WHETHER IN CONTRACT, TORT OR OTHERWISE,
// ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER
// DEALINGS IN THE SOFTWARE.

#ifndef QOR_PP_H_COMPONENTS_FRAMEWORK_TUI_DOM_TABLE
#define QOR_PP_H_COMPONENTS_FRAMEWORK_TUI_DOM_TABLE

#include <string>
#include <vector>

#include "elements.h"

namespace qor{ namespace components{ namespace tui {

    class Table;
    class TableSelection;

    //Table is a utility to draw tables.
    ///
    /// **example**
    /// ```cpp
    /// auto table = Table({
    ///  {"X", "Y"},
    ///  {"-1", "1"},
    ///  {"+0", "0"},
    ///  {"+1", "1"},
    /// });
    ///
    /// table.SelectAll().Border(LIGHT);
    /// table.SelectRow(1).Border(DOUBLE);
    /// table.SelectRow(1).SeparatorInternal(LIGHT);
    ///
    /// std::move(table).Render();

    class qor_pp_module_interface(QOR_TUI) Table 
    {
    public:
        Table();
        explicit Table(std::vector<std::vector<std::string>>);
        explicit Table(std::vector<std::vector<Element>>);
        Table(std::initializer_list<std::vector<std::string>> init);
        TableSelection SelectAll();
        TableSelection SelectCell(int column, int row);
        TableSelection SelectRow(int row_index);
        TableSelection SelectRows(int row_min, int row_max);
        TableSelection SelectColumn(int column_index);
        TableSelection SelectColumns(int column_min, int column_max);
        TableSelection SelectRectangle(int column_min,
                                        int column_max,
                                        int row_min,
                                        int row_max);
        Element Render();

    private:
        void Initialize(std::vector<std::vector<Element>>);
        friend TableSelection;
        std::vector<std::vector<Element>> elements_;
        int input_dim_x_ = 0;
        int input_dim_y_ = 0;
        int dim_x_ = 0;
        int dim_y_ = 0;
    };

    class TableSelection 
    {
    public:
        void Decorate(Decorator);
        void DecorateAlternateRow(Decorator, int modulo = 2, int shift = 0);
        void DecorateAlternateColumn(Decorator, int modulo = 2, int shift = 0);
        void DecorateCells(Decorator);
        void DecorateCellsAlternateColumn(Decorator, int modulo = 2, int shift = 0);
        void DecorateCellsAlternateRow(Decorator, int modulo = 2, int shift = 0);
        void Border(BorderStyle border = LIGHT);
        void BorderLeft(BorderStyle border = LIGHT);
        void BorderRight(BorderStyle border = LIGHT);
        void BorderTop(BorderStyle border = LIGHT);
        void BorderBottom(BorderStyle border = LIGHT);
        void Separator(BorderStyle border = LIGHT);
        void SeparatorVertical(BorderStyle border = LIGHT);
        void SeparatorHorizontal(BorderStyle border = LIGHT);

    private:
        friend Table;
        Table* table_;
        int x_min_;
        int x_max_;
        int y_min_;
        int y_max_;
    };

}}}//qor::components::tui

#endif//QOR_PP_H_COMPONENTS_FRAMEWORK_TUI_DOM_TABLE

