// Copyright Querysoft Limited 2008 - 2025
//
// Permission is hereby granted, free of charge, to any person or organization
// obtaining a copy of the software and accompanying documentation covered by
// this license (the "Software") to use, reproduce, display, distribute,
// execute, and transmit the Software, and to prepare derivative works of the
// Software, and to permit third-parties to whom the Software is furnished to
// do so, all subject to the following:
// 
// The copyright notices in the Software and this entire statement, including
// the above license grant, this restriction and the following disclaimer,
// must be included in all copies of the Software, in whole or in part, and
// all derivative works of the Software, unless such copies or derivative
// works are solely in the form of machine-executable object code generated by
// a source language processor.
// 
// THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
// IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
// FITNESS FOR A PARTICULAR PURPOSE, TITLE AND NON-INFRINGEMENT. IN NO EVENT
// SHALL THE COPYRIGHT HOLDERS OR ANYONE DISTRIBUTING THE SOFTWARE BE LIABLE
// FOR ANY DAMAGES OR OTHER LIABILITY, WHETHER IN CONTRACT, TORT OR OTHERWISE,
// ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER
// DEALINGS IN THE SOFTWARE.

#ifndef QOR_PP_H_COMPONENTS_FRAMEWORK_TUI_UI_COMPONENT
#define QOR_PP_H_COMPONENTS_FRAMEWORK_TUI_UI_COMPONENT

#include <functional>
#include <memory>
#include <utility>

#include "componentbase.h"
#include "componentoptions.h"
#include "../dom/elements.h"
#include "../util/ref.h"

namespace qor{ namespace components{ namespace tui {

    struct qor_pp_module_interface(QOR_TUI) ButtonOption;
    struct qor_pp_module_interface(QOR_TUI) CheckboxOption;
    struct qor_pp_module_interface(QOR_TUI) Event;
    struct qor_pp_module_interface(QOR_TUI) InputOption;
    struct qor_pp_module_interface(QOR_TUI) MenuOption;
    struct qor_pp_module_interface(QOR_TUI) RadioboxOption;
    struct qor_pp_module_interface(QOR_TUI) MenuEntryOption;

    template <class T, class... Args>
    std::shared_ptr<T> Make(Args&&... args) 
    {
        return std::make_shared<T>(std::forward<Args>(args)...);
    }

    // Pipe operator to decorate components.
    using ComponentDecorator = std::function<Component(Component)>;
    using ElementDecorator = std::function<Element(Element)>;
    qor_pp_module_interface(QOR_TUI) Component operator|(Component component, ComponentDecorator decorator);
    qor_pp_module_interface(QOR_TUI) Component operator|(Component component, ElementDecorator decorator);
    qor_pp_module_interface(QOR_TUI) Component& operator|=(Component& component, ComponentDecorator decorator);
    qor_pp_module_interface(QOR_TUI) Component& operator|=(Component& component, ElementDecorator decorator);

    namespace Container 
    {
        qor_pp_module_interface(QOR_TUI) Component Vertical(Components children);
        qor_pp_module_interface(QOR_TUI) Component Vertical(Components children, int* selector);
        qor_pp_module_interface(QOR_TUI) Component Horizontal(Components children);
        qor_pp_module_interface(QOR_TUI) Component Horizontal(Components children, int* selector);
        qor_pp_module_interface(QOR_TUI) Component Tab(Components children, int* selector);
        qor_pp_module_interface(QOR_TUI) Component Stacked(Components children);
    }//Container

    qor_pp_module_interface(QOR_TUI) Component Button(ButtonOption options);
    qor_pp_module_interface(QOR_TUI) Component Button(ConstStringRef label, std::function<void()> on_click, ButtonOption options = ButtonOption::Simple());

    qor_pp_module_interface(QOR_TUI) Component Checkbox(CheckboxOption options);
    qor_pp_module_interface(QOR_TUI) Component Checkbox(ConstStringRef label, bool* checked, CheckboxOption options = CheckboxOption::Simple());

    qor_pp_module_interface(QOR_TUI) Component Input(InputOption options = {});
    qor_pp_module_interface(QOR_TUI) Component Input(StringRef content, InputOption options = {});
    qor_pp_module_interface(QOR_TUI) Component Input(StringRef content, StringRef placeholder, InputOption options = {});

    qor_pp_module_interface(QOR_TUI) Component Menu(MenuOption options);
    qor_pp_module_interface(QOR_TUI) Component Menu(ConstStringListRef entries, int* selected_, MenuOption options = MenuOption::Vertical());
    qor_pp_module_interface(QOR_TUI) Component MenuEntry(MenuEntryOption options);
    qor_pp_module_interface(QOR_TUI) Component MenuEntry(ConstStringRef label, MenuEntryOption options = {});

    qor_pp_module_interface(QOR_TUI) Component Radiobox(RadioboxOption options);
    qor_pp_module_interface(QOR_TUI) Component Radiobox(ConstStringListRef entries, int* selected_, RadioboxOption options = {});

    qor_pp_module_interface(QOR_TUI) Component Dropdown(ConstStringListRef entries, int* selected);
    qor_pp_module_interface(QOR_TUI) Component Dropdown(DropdownOption options);

    qor_pp_module_interface(QOR_TUI) Component Toggle(ConstStringListRef entries, int* selected);

    // General slider constructor:
    template <typename T> Component Slider(SliderOption<T> options);

    // Shorthand without the `SliderOption` constructor:
    qor_pp_module_interface(QOR_TUI) Component Slider(ConstStringRef label, Ref<int> value, ConstRef<int> min = 0, ConstRef<int> max = 100, ConstRef<int> increment = 5);
    qor_pp_module_interface(QOR_TUI) Component Slider(ConstStringRef label, Ref<float> value, ConstRef<float> min = 0.f, ConstRef<float> max = 100.f, ConstRef<float> increment = 5.f);
    qor_pp_module_interface(QOR_TUI) Component Slider(ConstStringRef label, Ref<long> value, ConstRef<long> min = 0L, ConstRef<long> max = 100L, ConstRef<long> increment = 5L);

    qor_pp_module_interface(QOR_TUI) Component ResizableSplit(ResizableSplitOption options);
    qor_pp_module_interface(QOR_TUI) Component ResizableSplitLeft(Component main, Component back, int* main_size);
    qor_pp_module_interface(QOR_TUI) Component ResizableSplitRight(Component main, Component back, int* main_size);
    qor_pp_module_interface(QOR_TUI) Component ResizableSplitTop(Component main, Component back, int* main_size);
    qor_pp_module_interface(QOR_TUI) Component ResizableSplitBottom(Component main, Component back, int* main_size);

    qor_pp_module_interface(QOR_TUI) Component Renderer(Component child, std::function<Element()>);
    qor_pp_module_interface(QOR_TUI) Component Renderer(std::function<Element()>);
    qor_pp_module_interface(QOR_TUI) Component Renderer(std::function<Element(bool /* focused */)>);
    qor_pp_module_interface(QOR_TUI) ComponentDecorator Renderer(ElementDecorator);
    qor_pp_module_interface(QOR_TUI) Component CatchEvent(Component child, std::function<bool(Event)>);
    qor_pp_module_interface(QOR_TUI) ComponentDecorator CatchEvent(std::function<bool(Event)> on_event);
    qor_pp_module_interface(QOR_TUI) Component Maybe(Component, const bool* show);
    qor_pp_module_interface(QOR_TUI) Component Maybe(Component, std::function<bool()>);
    qor_pp_module_interface(QOR_TUI) ComponentDecorator Maybe(const bool* show);
    qor_pp_module_interface(QOR_TUI) ComponentDecorator Maybe(std::function<bool()>);
    qor_pp_module_interface(QOR_TUI) Component Modal(Component main, Component modal, const bool* show_modal);
    qor_pp_module_interface(QOR_TUI) ComponentDecorator Modal(Component modal, const bool* show_modal);
    qor_pp_module_interface(QOR_TUI) Component Collapsible(ConstStringRef label, Component child, Ref<bool> show = false);
    qor_pp_module_interface(QOR_TUI) Component Hoverable(Component component, bool* hover);
    qor_pp_module_interface(QOR_TUI) Component Hoverable(Component component, std::function<void()> on_enter, std::function<void()> on_leave);
    qor_pp_module_interface(QOR_TUI) Component Hoverable(Component component, std::function<void(bool)> on_change);
    qor_pp_module_interface(QOR_TUI) ComponentDecorator Hoverable(bool* hover);
    qor_pp_module_interface(QOR_TUI) ComponentDecorator Hoverable(std::function<void()> on_enter, std::function<void()> on_leave);
    qor_pp_module_interface(QOR_TUI) ComponentDecorator Hoverable(std::function<void(bool)> on_change);
    qor_pp_module_interface(QOR_TUI) Component Window(WindowOptions option);

}}}//qor::components::tui

#endif//QOR_PP_H_COMPONENTS_FRAMEWORK_TUI_UI_COMPONENT

