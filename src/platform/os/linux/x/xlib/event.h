// Copyright Querysoft Limited 2008 - 2025
//
// Permission is hereby granted, free of charge, to any person or organization
// obtaining a copy of the software and accompanying documentation covered by
// this license (the "Software") to use, reproduce, display, distribute,
// execute, and transmit the Software, and to prepare derivative works of the
// Software, and to permit third-parties to whom the Software is furnished to
// do so, all subject to the following:
// 
// The copyright notices in the Software and this entire statement, including
// the above license grant, this restriction and the following disclaimer,
// must be included in all copies of the Software, in whole or in part, and
// all derivative works of the Software, unless such copies or derivative
// works are solely in the form of machine-executable object code generated by
// a source language processor.
// 
// THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
// IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
// FITNESS FOR A PARTICULAR PURPOSE, TITLE AND NON-INFRINGEMENT. IN NO EVENT
// SHALL THE COPYRIGHT HOLDERS OR ANYONE DISTRIBUTING THE SOFTWARE BE LIABLE
// FOR ANY DAMAGES OR OTHER LIABILITY, WHETHER IN CONTRACT, TORT OR OTHERWISE,
// ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER
// DEALINGS IN THE SOFTWARE.

#ifndef QOR_PP_H_LINUX_X_EVENT
#define QOR_PP_H_LINUX_X_EVENT

#include <functional>

namespace qor{ namespace platform { namespace nslinux{ namespace x{

    struct qor_pp_module_interface(QOR_LINX) AnyEvent
    {
        int type;
        unsigned long serial;	// # of last request processed by server
        int send_event;	        // true if this came from a SendEvent request
        void* display;          // Display the event was read from
        unsigned long window;	// window on which event was requested in event mask
    };

    struct qor_pp_module_interface(QOR_LINX) KeyEvent
    {
        int type;		            // of event
        unsigned long serial;	    // # of last request processed by server
        int send_event;	            // true if this came from a SendEvent request
        void* display;	            // Display the event was read from
        unsigned long window;	    // "event" window it is reported relative to
        unsigned long root;	        // root window that the event occurred on
        unsigned long subwindow;	// child window
        unsigned long time;		    // milliseconds
        int x, y;		            // pointer x, y coordinates in event window
        int x_root, y_root;	        // coordinates relative to root
        unsigned int state;	        // key or button mask
        unsigned int keycode;	    // detail
        int same_screen;	        // same screen flag
    };
    typedef KeyEvent KeyPressedEvent;
    typedef KeyEvent KeyReleasedEvent;

    struct qor_pp_module_interface(QOR_LINX) ButtonEvent
    {
        int type;		            // of event
        unsigned long serial;	    // # of last request processed by server
        int send_event;	            // true if this came from a SendEvent request
        void* display;  	        // Display the event was read from
        unsigned long window;	    // "event" window it is reported relative to
        unsigned long root;	        // root window that the event occurred on
        unsigned long subwindow;    // child window
        unsigned long time;         // milliseconds
        int x, y;		            // pointer x, y coordinates in event window
        int x_root, y_root;	        // coordinates relative to root
        unsigned int state;	        // key or button mask
        unsigned int button;	    // detail
        int same_screen;	        // same screen flag
    };
    typedef ButtonEvent ButtonPressedEvent;
    typedef ButtonEvent ButtonReleasedEvent;

    struct qor_pp_module_interface(QOR_LINX) MotionEvent
    {
        int type;		            // of event
        unsigned long serial;	    // # of last request processed by server
        int send_event;	            // true if this came from a SendEvent request
        void* display;	            // Display the event was read from
        unsigned long window;	    // "event" window reported relative to
        unsigned long root;	        // root window that the event occurred on
        unsigned long subwindow;	// child window
        unsigned long time;		    // milliseconds
        int x, y;		            // pointer x, y coordinates in event window
        int x_root, y_root;	        // coordinates relative to root
        unsigned int state;	        // key or button mask
        char is_hint;		        // detail
        int same_screen;	        // same screen flag
    };
    typedef MotionEvent PointerMovedEvent;

    struct qor_pp_module_interface(QOR_LINX) CrossingEvent
    {
        int type;		/* of event */
        unsigned long serial;	/* # of last request processed by server */
        int send_event;	/* true if this came from a SendEvent request */
        void *display;	/* Display the event was read from */
        unsigned int window;	        /* "event" window reported relative to */
        unsigned int root;	        /* root window that the event occurred on */
        unsigned int subwindow;	/* child window */
        unsigned int time;		/* milliseconds */
        int x, y;		/* pointer x, y coordinates in event window */
        int x_root, y_root;	/* coordinates relative to root */
        int mode;		/* NotifyNormal, NotifyGrab, NotifyUngrab */
        int detail;
        /*
        * NotifyAncestor, NotifyVirtual, NotifyInferior,
        * NotifyNonlinear,NotifyNonlinearVirtual
        */
        int same_screen;	/* same screen flag */
        int focus;		/* boolean focus */
        unsigned int state;	/* key or button mask */
    };
    typedef CrossingEvent EnterWindowEvent;
    typedef CrossingEvent LeaveWindowEvent;

    struct qor_pp_module_interface(QOR_LINX) FocusChangeEvent
    {
        int type;		/* FocusIn or FocusOut */
        unsigned long serial;	/* # of last request processed by server */
        int send_event;	/* true if this came from a SendEvent request */
        void* display;	/* Display the event was read from */
        unsigned int window;		/* window of event */
        int mode;		/* NotifyNormal, NotifyWhileGrabbed, NotifyGrab, NotifyUngrab */
        int detail;
        /*
        * NotifyAncestor, NotifyVirtual, NotifyInferior,
        * NotifyNonlinear,NotifyNonlinearVirtual, NotifyPointer,
        * NotifyPointerRoot, NotifyDetailNone
        */
    };
    typedef FocusChangeEvent FocusInEvent;
    typedef FocusChangeEvent FocusOutEvent;

    struct qor_pp_module_interface(QOR_LINX) ExposeEvent
    {
        int type;
        unsigned long serial;	/* # of last request processed by server */
        int send_event;	/* true if this came from a SendEvent request */
        void* display;	/* Display the event was read from */
        unsigned int window;
        int x, y;
        int width, height;
        int count;		/* if non-zero, at least this many more */
    };

    struct qor_pp_module_interface(QOR_LINX) GraphicsExposeEvent
    {
        int type;
        unsigned long serial;	/* # of last request processed by server */
        int send_event;	/* true if this came from a SendEvent request */
        void* display;	/* Display the event was read from */
        unsigned long drawable;
        int x, y;
        int width, height;
        int count;		/* if non-zero, at least this many more */
        int major_code;		/* core is CopyArea or CopyPlane */
        int minor_code;		/* not defined in the core */
    };

    struct qor_pp_module_interface(QOR_LINX) NoExposeEvent
    {
        int type;
        unsigned long serial;	/* # of last request processed by server */
        int send_event;	/* true if this came from a SendEvent request */
        void* display;	/* Display the event was read from */
        unsigned long drawable;
        int major_code;		/* core is CopyArea or CopyPlane */
        int minor_code;		/* not defined in the core */
    };

    struct qor_pp_module_interface(QOR_LINX) VisibilityEvent
    {
        int type;
        unsigned long serial;	/* # of last request processed by server */
        int send_event;	/* true if this came from a SendEvent request */
        void* display;	/* Display the event was read from */
        unsigned long window;
        int state;		/* Visibility state */
    };

    struct qor_pp_module_interface(QOR_LINX) CreateWindowEvent
    {
        int type;
        unsigned long serial;	/* # of last request processed by server */
        int send_event;	/* true if this came from a SendEvent request */
        void* display;	/* Display the event was read from */
        unsigned long parent;		/* parent of the window */
        unsigned long window;		/* window id of window created */
        int x, y;		/* window location */
        int width, height;	/* size of window */
        int border_width;	/* border width */
        int override_redirect;	/* creation should be overridden */
    };

    struct qor_pp_module_interface(QOR_LINX) DestroyWindowEvent
    {
        int type;
        unsigned long serial;	/* # of last request processed by server */
        int send_event;	/* true if this came from a SendEvent request */
        void* display;	/* Display the event was read from */
        unsigned long event;
        unsigned long window;
    };

    struct qor_pp_module_interface(QOR_LINX) UnmapEvent
    {
        int type;
        unsigned long serial;	/* # of last request processed by server */
        int send_event;	/* true if this came from a SendEvent request */
        void* display;	/* Display the event was read from */
        unsigned long event;
        unsigned long window;
        int from_configure;
    };

    struct qor_pp_module_interface(QOR_LINX) MapEvent
    {
        int type;
        unsigned long serial;	/* # of last request processed by server */
        int send_event;	/* true if this came from a SendEvent request */
        void* display;	/* Display the event was read from */
        unsigned long event;
        unsigned long window;
        int override_redirect;	/* boolean, is override set... */
    };

    struct qor_pp_module_interface(QOR_LINX) MapRequestEvent
    {
        int type;
        unsigned long serial;	/* # of last request processed by server */
        int send_event;	/* true if this came from a SendEvent request */
        void* display;	/* Display the event was read from */
        unsigned long parent;
        unsigned long window;
    };

    struct qor_pp_module_interface(QOR_LINX) ReparentEvent
    {
        int type;
        unsigned long serial;	/* # of last request processed by server */
        int send_event;	/* true if this came from a SendEvent request */
        void* display;	/* Display the event was read from */
        unsigned long event;
        unsigned long window;
        unsigned long parent;
        int x, y;
        int override_redirect;
    };

    struct qor_pp_module_interface(QOR_LINX) ConfigureEvent
    {
        int type;
        unsigned long serial;	/* # of last request processed by server */
        int send_event;	/* true if this came from a SendEvent request */
        void* display;	/* Display the event was read from */
        unsigned long event;
        unsigned long window;
        int x, y;
        int width, height;
        int border_width;
        unsigned long above;
        int override_redirect;
    };

    struct qor_pp_module_interface(QOR_LINX) GravityEvent
    {
        int type;
        unsigned long serial;	/* # of last request processed by server */
        int send_event;	/* true if this came from a SendEvent request */
        void* display;	/* Display the event was read from */
        unsigned long event;
        unsigned long window;
        int x, y;
    };

    struct qor_pp_module_interface(QOR_LINX) ResizeRequestEvent
    {
        int type;
        unsigned long serial;	/* # of last request processed by server */
        int send_event;	/* true if this came from a SendEvent request */
        void* display;	/* Display the event was read from */
        unsigned long window;
        int width, height;
    };

    struct qor_pp_module_interface(QOR_LINX) ConfigureRequestEvent
    {
        int type;
        unsigned long serial;	/* # of last request processed by server */
        int send_event;	/* true if this came from a SendEvent request */
        void* display;	/* Display the event was read from */
        unsigned long parent;
        unsigned long window;
        int x, y;
        int width, height;
        int border_width;
        unsigned long above;
        int detail;		/* Above, Below, TopIf, BottomIf, Opposite */
        unsigned long value_mask;
    };

    struct qor_pp_module_interface(QOR_LINX) CirculateEvent
    {
        int type;
        unsigned long serial;	/* # of last request processed by server */
        int send_event;	/* true if this came from a SendEvent request */
        void* display;	/* Display the event was read from */
        unsigned long event;
        unsigned long window;
        int place;		/* PlaceOnTop, PlaceOnBottom */
    };

    struct qor_pp_module_interface(QOR_LINX) CirculateRequestEvent
    {
        int type;
        unsigned long serial;	/* # of last request processed by server */
        int send_event;	/* true if this came from a SendEvent request */
        void* display;	/* Display the event was read from */
        unsigned long parent;
        unsigned long window;
        int place;		/* PlaceOnTop, PlaceOnBottom */
    };

    struct qor_pp_module_interface(QOR_LINX) PropertyEvent
    {
        int type;
        unsigned long serial;	/* # of last request processed by server */
        int send_event;	/* true if this came from a SendEvent request */
        void* display;	/* Display the event was read from */
        unsigned long window;
        unsigned long atom;
        unsigned long time;
        int state;		/* NewValue, Deleted */
    };

    struct qor_pp_module_interface(QOR_LINX) SelectionClearEvent
    {
        int type;
        unsigned long serial;	/* # of last request processed by server */
        int send_event;	/* true if this came from a SendEvent request */
        void* display;	/* Display the event was read from */
        unsigned long window;
        unsigned long selection;
        unsigned long time;
    };

    struct qor_pp_module_interface(QOR_LINX) SelectionRequestEvent
    {
        int type;
        unsigned long serial;	/* # of last request processed by server */
        int send_event;	/* true if this came from a SendEvent request */
        void* display;	/* Display the event was read from */
        unsigned long owner;
        unsigned long requestor;
        unsigned long selection;
        unsigned long target;
        unsigned long property;
        unsigned long time;
    };

    struct qor_pp_module_interface(QOR_LINX) SelectionEvent
    {
        int type;
        unsigned long serial;	/* # of last request processed by server */
        int send_event;	/* true if this came from a SendEvent request */
        void* display;	/* Display the event was read from */
        unsigned long requestor;
        unsigned long selection;
        unsigned long target;
        unsigned long property;		/* ATOM or None */
        unsigned long time;
    };

    struct qor_pp_module_interface(QOR_LINX) ColormapEvent
    {
        int type;
        unsigned long serial;	/* # of last request processed by server */
        int send_event;	/* true if this came from a SendEvent request */
        void* display;	/* Display the event was read from */
        unsigned long window;
        unsigned long colormap;	/* COLORMAP or None */
        int c_new;		/* C++ */
        int state;		/* ColormapInstalled, ColormapUninstalled */
    };

    struct qor_pp_module_interface(QOR_LINX) ClientMessageEvent
    {
        int type;
        unsigned long serial;	/* # of last request processed by server */
        int send_event;	/* true if this came from a SendEvent request */
        void* display;	/* Display the event was read from */
        unsigned long window;
        unsigned long message_type;
        int format;
        union 
        {
            char b[20];
            short s[10];
            long l[5];
        } data;
    };

    struct qor_pp_module_interface(QOR_LINX) MappingEvent
    {
        int type;
        unsigned long serial;	/* # of last request processed by server */
        int send_event;	/* true if this came from a SendEvent request */
        void* display;	/* Display the event was read from */
        unsigned long window;		/* unused */
        int request;		/* one of MappingModifier, MappingKeyboard, MappingPointer */
        int first_keycode;	/* first keycode */
        int count;		/* defines range of change w. first_keycode*/
    };

    struct qor_pp_module_interface(QOR_LINX) ErrorEvent
    {
        int type;
        void* display;	/* Display the event was read from */
        unsigned long resourceid;		/* resource id */
        unsigned long serial;	/* serial number of failed request */
        unsigned char error_code;	/* error code of failed request */
        unsigned char request_code;	/* Major op-code of failed request */
        unsigned char minor_code;	/* Minor op-code of failed request */
    };

    // generated on EnterWindow and FocusIn  when KeyMapState selected
    struct qor_pp_module_interface(QOR_LINX) KeymapEvent
    {
        int type;
        unsigned long serial;	/* # of last request processed by server */
        int send_event;	/* true if this came from a SendEvent request */
        void* display;	/* Display the event was read from */
        unsigned long window;
        char key_vector[32];
    };

    struct qor_pp_module_interface(QOR_LINX) GenericEvent
    {
        int            type;         /* of event. Always GenericEvent */
        unsigned long  serial;       /* # of last request processed */
        int           send_event;   /* true if from SendEvent request */
        void*           display;     /* Display the event was read from */
        int            extension;    /* major opcode of extension that caused the event */
        int            evtype;       /* actual event type. */
    };

    struct qor_pp_module_interface(QOR_LINX) GenericEventCookie
    {
        int            type;         /* of event. Always GenericEvent */
        unsigned long  serial;       /* # of last request processed */
        int           send_event;   /* true if from SendEvent request */
        void*           display;     /* Display the event was read from */
        int            extension;    /* major opcode of extension that caused the event */
        int            evtype;       /* actual event type. */
        unsigned int   cookie;
        void           *data;
    };

    union qor_pp_module_interface(QOR_LINX) Event 
    {
        int type;
        AnyEvent xany;
        KeyEvent xkey;
        ButtonEvent xbutton;
        MotionEvent xmotion;
        CrossingEvent xcrossing;
        FocusChangeEvent xfocus;
        ExposeEvent xexpose;
        GraphicsExposeEvent xgraphicsexpose;
        NoExposeEvent xnoexpose;
        VisibilityEvent xvisibility;
        CreateWindowEvent xcreatewindow;
        DestroyWindowEvent xdestroywindow;
        UnmapEvent xunmap;
        MapEvent xmap;
        MapRequestEvent xmaprequest;
        ReparentEvent xreparent;
        ConfigureEvent xconfigure;
        GravityEvent xgravity;
        ResizeRequestEvent xresizerequest;
        ConfigureRequestEvent xconfigurerequest;
        CirculateEvent xcirculate;
        CirculateRequestEvent xcirculaterequest;
        PropertyEvent xproperty;
        SelectionClearEvent xselectionclear;
        SelectionRequestEvent xselectionrequest;
        SelectionEvent xselection;
        ColormapEvent xcolormap;
        ClientMessageEvent xclient;
        MappingEvent xmapping;
        ErrorEvent xerror;
        KeymapEvent xkeymap;
        GenericEvent xgeneric;
        GenericEventCookie xcookie;
        long pad[24];
    };

    enum EventType
    {
        KeyPressType		 = 2,
        KeyReleaseType		 = 3,
        ButtonPressType		 = 4,
        ButtonReleaseType	 = 5,
        MotionNotifyType	 = 6,
        EnterNotifyType		 = 7,
        LeaveNotifyType		 = 8,
        FocusInType			 = 9,
        FocusOutType		 = 10,
        KeymapNotifyType	 = 11,
        ExposeType			 = 12,
        GraphicsExposeType	 = 13,
        NoExposeType		 = 14,
        VisibilityNotifyType = 15,
        CreateNotifyType	 = 16,
        DestroyNotifyType	 = 17,
        UnmapNotifyType		 = 18,
        MapNotifyType		 = 19,
        MapRequestType		 = 20,
        ReparentNotifyType	 = 21,
        ConfigureNotifyType	 = 22,
        ConfigureRequestType = 23,
        GravityNotifyType	 = 24,
        ResizeRequestType	 = 25,
        CirculateNotifyType	 = 26,
        CirculateRequestType = 27,
        PropertyNotifyType	 = 28,
        SelectionClearType	 = 29,
        SelectionRequestType = 30,
        SelectionNotifyType	 = 31,
        ColormapNotifyType	 = 32,
        ClientMessageType	 = 33,
        MappingNotifyType	 = 34,
        GenericEventType	 = 35,
    };

    typedef std::function<int(Event&)> eventHandler;

    static const long NoEventMask			= 0L;;
    static const long KeyPressMask			= (1L<<0);
    static const long KeyReleaseMask		= (1L<<1);
    static const long ButtonPressMask		= (1L<<2);
    static const long ButtonReleaseMask		= (1L<<3);
    static const long EnterWindowMask		= (1L<<4);
    static const long LeaveWindowMask		= (1L<<5);
    static const long PointerMotionMask		= (1L<<6);
    static const long PointerMotionHintMask	= (1L<<7);
    static const long Button1MotionMask		= (1L<<8);
    static const long Button2MotionMask		= (1L<<9);
    static const long Button3MotionMask		= (1L<<10);
    static const long Button4MotionMask		= (1L<<11);
    static const long Button5MotionMask		= (1L<<12);
    static const long ButtonMotionMask		= (1L<<13);
    static const long KeymapStateMask		= (1L<<14);
    static const long ExposureMask			= (1L<<15);
    static const long VisibilityChangeMask	= (1L<<16);
    static const long StructureNotifyMask	= (1L<<17);
    static const long ResizeRedirectMask	= (1L<<18);
    static const long SubstructureNotifyMask= (1L<<19);
    static const long SubstructureRedirectMask=(1L<<20);
    static const long FocusChangeMask		= (1L<<21);
    static const long PropertyChangeMask	= (1L<<22);
    static const long ColormapChangeMask	= (1L<<23);
    static const long OwnerGrabButtonMask	= (1L<<24);

}}}}//qor::platform::nslinux::x
    
#endif//QOR_PP_H_LINUX_X_EVENT