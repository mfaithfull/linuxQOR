// Copyright Querysoft Limited 2008 - 2025
//
// Permission is hereby granted, free of charge, to any person or organization
// obtaining a copy of the software and accompanying documentation covered by
// this license (the "Software") to use, reproduce, display, distribute,
// execute, and transmit the Software, and to prepare derivative works of the
// Software, and to permit third-parties to whom the Software is furnished to
// do so, all subject to the following:
// 
// The copyright notices in the Software and this entire statement, including
// the above license grant, this restriction and the following disclaimer,
// must be included in all copies of the Software, in whole or in part, and
// all derivative works of the Software, unless such copies or derivative
// works are solely in the form of machine-executable object code generated by
// a source language processor.
// 
// THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
// IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
// FITNESS FOR A PARTICULAR PURPOSE, TITLE AND NON-INFRINGEMENT. IN NO EVENT
// SHALL THE COPYRIGHT HOLDERS OR ANYONE DISTRIBUTING THE SOFTWARE BE LIABLE
// FOR ANY DAMAGES OR OTHER LIABILITY, WHETHER IN CONTRACT, TORT OR OTHERWISE,
// ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER
// DEALINGS IN THE SOFTWARE.

namespace qor{ namespace platform { namespace nslinux{ namespace x{

    /*// Configure window value mask bits 
#define CWX (1<<0)
#define CWY (1<<1)
#define CWWidth (1<<2)
#define CWHeight (1<<3)
#define CWBorderWidth (1<<4)
#define CWSibling (1<<5)
#define CWStackMode (1<<6)
*/

    struct qor_pp_module_interface(QOR_LINX) WindowChanges
    {
        int x, y;
        int width, height;
        int border_width;
        unsigned long sibling;
        int stack_mode;
    };

    class qor_pp_module_interface(QOR_LINX) WindowChangeQuery
    {
    public:

        WindowChangeQuery() : m_windowChanges{}, m_mask {0}
        {
        }

        ~WindowChangeQuery() = default;


        WindowChanges& Info()
        {
            return m_windowChanges;
        }

        unsigned long Mask()
        {
            return m_mask;
        }

        void Setx(int x)
        {
            m_windowChanges.x = x;
            m_mask |= (1<<0);
        }

        void Sety(int y)
        {
            m_windowChanges.y = y;
            m_mask |= (1<<1);
        }

        void SetWidth(int w)
        {
            m_windowChanges.width = w;
            m_mask |= (1<<2);
        }

        void SetHeight(int h)
        {
            m_windowChanges.height = h;
            m_mask |= (1<<3);            
        }

        void SetBorderWidth(int width)
        {
            m_windowChanges.border_width = width;
            m_mask |= (1<<4);
        }

        void SetSibling(unsigned long sibling)
        {
            m_windowChanges.sibling = sibling;
            m_mask |= (1<<5);
        }

        void SetStackMode(int stack_mode)
        {
            m_windowChanges.stack_mode = stack_mode;
            m_mask |= (1<<6);
        }

    private:

        unsigned long m_mask;
        WindowChanges m_windowChanges;
    };

    struct SetWindowAttributes
    {
        unsigned long background_pixmap; // background, None, or ParentRelative
        unsigned long background_pixel; // background pixel 
        unsigned long border_pixmap; // border of the window or CopyFromParent 
        unsigned long border_pixel; // border pixel value 
        int bit_gravity; // one of bit gravity values 
        int win_gravity; // one of the window gravity values 
        int backing_store; // NotUseful, WhenMapped, Always 
        unsigned long backing_planes; // planes to be preserved if possible 
        unsigned long backing_pixel; // value to use in restoring planes 
        int save_under; // should bits under be saved? (popups) 
        long event_mask; // set of events that should be saved 
        long do_not_propagate_mask; // set of events that should not propagate  Bool override_redirect;  boolean value for override_redirect 
        unsigned long colormap; // color map to be associated with window 
        unsigned long cursor; // cursor to be displayed (or None) 
    };

    struct WindowAttributes
    {
        int x, y;			/* location of window */
        int width, height;		/* width and height of window */
        int border_width;		/* border width of window */
        int depth;          	/* depth of window */
        void* visual;		/* the associated visual structure */
        unsigned long root;        	/* root of screen containing window */
        int c_class;		/* C++ InputOutput, InputOnly*/
        int bit_gravity;		/* one of bit gravity values */
        int win_gravity;		/* one of the window gravity values */
        int backing_store;		/* NotUseful, WhenMapped, Always */
        unsigned long backing_planes;/* planes to be preserved if possible */
        unsigned long backing_pixel;/* value to be used when restoring planes */
        int save_under;		/* boolean, should bits under be saved? */
        unsigned long colormap;		/* color map to be associated with window */
        int map_installed;		/* boolean, is color map currently installed*/
        int map_state;		/* IsUnmapped, IsUnviewable, IsViewable */
        long all_event_masks;	/* set of events all people have interest in*/
        long your_event_mask;	/* my event mask */
        long do_not_propagate_mask; /* set of events that should not propagate */
        int override_redirect;	/* boolean value for override-redirect */
        void* screen;		/* back pointer to correct screen */
    };


    class qor_pp_module_interface(QOR_LINX) SetWindowAttributesQuery
    {
    public:

        SetWindowAttributesQuery() : m_windowAttributes{}, m_mask {0}
        {
        }

        ~SetWindowAttributesQuery() = default;


        SetWindowAttributes& Attributes()
        {
            return m_windowAttributes;
        }

        unsigned long Mask()
        {
            return m_mask;
        }

        void SetBackgroundPixmap(unsigned long background_pixmap)//; // background, None, or ParentRelative
        {
            m_windowAttributes.background_pixmap = background_pixmap;
            m_mask |= (1<<0);
        }
        
        void SetBackgrounPixel(unsigned long background_pixel)//; // background pixel 
        {
            m_windowAttributes.background_pixel = background_pixel;
            m_mask |= (1<<1);
        }

        void SetBorderPixmap(unsigned long border_pixmap)//; // border of the window or CopyFromParent 
        {
            m_windowAttributes.border_pixmap = border_pixmap;
            m_mask |= (1<<2);
        }

        void SetBorderPixel(unsigned long border_pixel)// border pixel value 
        {
            m_windowAttributes.border_pixel = border_pixel;
            m_mask |= (1<<3);
        }

        void SetBitGravity(int bit_gravity) // one of bit gravity values 
        {
            m_windowAttributes.bit_gravity = bit_gravity;
            m_mask |= (1<<4);
        }

        void SetWindowGravity(int win_gravity) // one of the window gravity values 
        {
            m_windowAttributes.win_gravity = win_gravity;
            m_mask |= (1<<5);
        }

        void SetBackStore(int backing_store) // NotUseful, WhenMapped, Always 
        {
            m_windowAttributes.backing_store = backing_store;
            m_mask |= (1<<6);
        }

        void SetBackingPlanes(unsigned long backing_planes) // planes to be preserved if possible 
        {
            m_windowAttributes.backing_planes = backing_planes;
            m_mask |= (1<<7);
        }

        void SetBackingPixel(unsigned long backing_pixel) // value to use in restoring planes 
        {
            m_windowAttributes.backing_pixel = backing_pixel;
            m_mask |= (1<<8);
        }

        void SetSaveUnder(int save_under) // should bits under be saved? (popups) 
        {
            m_windowAttributes.save_under = save_under;
            m_mask |= (1<<9);
        }

        void SetEventMask(long event_mask) // set of events that should be saved 
        {
            m_windowAttributes.event_mask = event_mask;
            m_mask |= (1<<10);
        }

        void SetDoNotPropagateMask(long do_not_propagate_mask) // set of events that should not propagate  Bool override_redirect;  boolean value for override_redirect 
        {
            m_windowAttributes.do_not_propagate_mask = do_not_propagate_mask;
            m_mask |= (1<<11);
        }

        void SetColourMap(unsigned long colourmap) // colour map to be associated with window 
        {
            m_windowAttributes.colormap = colourmap;
            m_mask |= (1<<12);
        }

        void SetCursor(unsigned long cursor) // cursor to be displayed (or None) 
        {
            m_windowAttributes.cursor = cursor;
            m_mask |= (1<<13);
        }
        
    private:

        unsigned long m_mask;
        SetWindowAttributes m_windowAttributes;
    };

    struct WMHints
    {
        long flags;		            // marks which fields in this structure are defined
        int input;		            // does this application rely on the window manager to get keyboard input?
        int initial_state;	        // see below
        unsigned long icon_pixmap;	// pixmap to be used as icon
        unsigned long icon_window;	// window to be used as icon
        int icon_x, icon_y;	        // initial position of icon
        unsigned long icon_mask;	// pixmap to be used as mask for icon_pixmap
        unsigned long window_group;	// id of related window group
	    // this structure may be extended in the future
    };

    #define MWM_HINTS_DECORATIONS (1L << 1)  // Flag to activate the 'decorations' field
 
    // Define the _MOTIF_WM_HINTS struct
    struct MotifWmHints
    {
        unsigned long flags;       // Which fields are active
        unsigned long functions;   // Window functions (move, resize, etc.)
        unsigned long decorations; // Decoration bitmask (0 = no decorations)
        unsigned long input_mode;  // Input mode hints
    };

    struct AspectRatio
    {
        int x;	                    // numerator
        int y;	                    // denominator
    };

    struct WMSizeHints
    {
        long flags;	                    // marks which fields in this structure are defined
        int x, y;		                // obsolete for new window mgrs, but clients
        int width, height;	            // should set so old wm's don't mess up
        int min_width, min_height;
        int max_width, max_height;
        int width_inc, height_inc;
        struct 
        {
            int x;	                    // numerator
            int y;	                    // denominator
        } min_aspect, max_aspect;
        int base_width, base_height;    // added by ICCCM version 1
        int win_gravity;                // added by ICCCM version 1

        void ResetFlags()
        {
            flags = 0;
        }

        void SetFlags(long bitSet)
        {
            flags = bitSet;
        }

        void SetPosition( int xPos, int yPos)
        {
            x = xPos;
            y = yPos;
            flags |= (1L << 2);//PPosition	(1L << 2) // program specified position
        }

        void SetSize(int w, int h)
        {
            width = w;
            height = h;
            flags |= (1L << 3);// PSize		(1L << 3) // program specified size
        }

        void SetMinSize(int min_w, int min_h)
        {
            min_width = min_w;
            min_height = min_h;
            flags |= (1L << 4);//PMinSize	(1L << 4) // program specified minimum size
        }

        void SetMaxSize(int max_w, int max_h)
        {
            max_width = max_w;
            max_height = max_h;
            flags |= (1L << 5);//PMaxSize	(1L << 5) // program specified maximum size
        }

        void SetResizeIncrements(int xInc, int yInc)
        {
             width_inc = xInc;
             height_inc = yInc;
             flags |= (1L << 6);//PResizeInc	(1L << 6) // program specified resize increments
        }

        void SetMinMaxAspectRatio( AspectRatio min, AspectRatio max)
        {
            min_aspect.x = min.x;
            min_aspect.y = min.y;
            max_aspect.x = max.x;
            max_aspect.y = max.y;
            flags |= (1L << 7);//PAspect		(1L << 7) // program specified min and max aspect ratios
        }

        void SetBaseSizeForIncrementing(int width, int height)
        {
            base_width = width;
            base_height = height;
            flags |= (1L << 8);//PBaseSize	(1L << 8) // program specified base for incrementing
        }

        void SetGravity(int gravity)
        {
            win_gravity = gravity;
            flags |= (1L << 9);//PWinGravity	(1L << 9) // program specified window gravity
        }
    };
     
}}}}//qor::platform::nslinux::x
