// Copyright Querysoft Limited 2008 - 2025
//
// Permission is hereby granted, free of charge, to any person or organization
// obtaining a copy of the software and accompanying documentation covered by
// this license (the "Software") to use, reproduce, display, distribute,
// execute, and transmit the Software, and to prepare derivative works of the
// Software, and to permit third-parties to whom the Software is furnished to
// do so, all subject to the following:
// 
// The copyright notices in the Software and this entire statement, including
// the above license grant, this restriction and the following disclaimer,
// must be included in all copies of the Software, in whole or in part, and
// all derivative works of the Software, unless such copies or derivative
// works are solely in the form of machine-executable object code generated by
// a source language processor.
// 
// THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
// IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
// FITNESS FOR A PARTICULAR PURPOSE, TITLE AND NON-INFRINGEMENT. IN NO EVENT
// SHALL THE COPYRIGHT HOLDERS OR ANYONE DISTRIBUTING THE SOFTWARE BE LIABLE
// FOR ANY DAMAGES OR OTHER LIABILITY, WHETHER IN CONTRACT, TORT OR OTHERWISE,
// ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER
// DEALINGS IN THE SOFTWARE.

#ifndef QOR_PP_H_OS_LINUX_GUI_GTK_WINDOW
#define QOR_PP_H_OS_LINUX_GUI_GTK_WINDOW
#include <gtk/gtk.h>

namespace qor{ namespace nslinux{ namespace gui {

    class Window
    {
    public:

        Window(GtkWindowType type)
        {
            m_gtk = GTK_WINDOW(gtk_window_new(type));
            m_gtkClass = GTK_WINDOW_GET_CLASS(m_gtk);
        }

        ~Window()
        {            
            gtk_widget_destroy(GTK_WIDGET(m_gtk));
            m_gtk = nullptr;
            m_gtkClass = nullptr;
        }

        void SetFocus(GtkWidget *focus)
        {
            m_gtkClass->set_focus(m_gtk, focus);
        }

        // G_SIGNAL_ACTION signals for keybindings

        void ActivateFocus()
        {
            m_gtkClass->activate_focus(m_gtk);
        }

        void ActivateDefault()
        {
            m_gtkClass->activate_default(m_gtk);
        }

        void KeysChanged()
        {
            m_gtkClass->keys_changed(m_gtk);
        }

        bool EnableDebugging(bool toggle)
        {
            return m_gtkClass->enable_debugging(m_gtk, toggle ? 1 : 0) ? true : false;
        }        

        unsigned long GetWindowType() const
        {
            return gtk_window_get_type();
        }

        void SetTitle(const std::string& title)
        {
            gtk_window_set_title(m_gtk, title.c_str());
        }

        std::string GetTitle()
        {
            const char* sz = gtk_window_get_title(m_gtk);
            std::string title(sz, strlen(sz));
            return title;
        }

        void SetWmClass(const std::string& wmclassName, const std::string& wmclassClass)
        {
            gtk_window_set_wmclass(m_gtk, wmclassName.c_str(), wmclassClass.c_str());
        }

        void SetRole(const std::string& role)
        {
            gtk_window_set_role(m_gtk, role.c_str());
        }

        void SetStartupId(const std::string& startupId)
        {
            gtk_window_set_startup_id(m_gtk, startupId.c_str());
        }

        std::string GetRole()
        {
            const char* sz = gtk_window_get_role(m_gtk);
            std::string role(sz, strlen(sz));
        }
        /*
        
        void       gtk_window_add_accel_group          (GtkWindow           *window, GtkAccelGroup	    *accel_group);
        void       gtk_window_remove_accel_group       (GtkWindow           *window, GtkAccelGroup	    *accel_group);
        void       gtk_window_set_position             (GtkWindow           *window, GtkWindowPosition    position);
        gboolean   gtk_window_activate_focus	       (GtkWindow           *window);
        void       gtk_window_set_focus                (GtkWindow           *window, GtkWidget           *focus);
        GtkWidget *gtk_window_get_focus                (GtkWindow           *window);
        void       gtk_window_set_default              (GtkWindow           *window, GtkWidget           *default_widget);
        GtkWidget *gtk_window_get_default_widget       (GtkWindow           *window);
        gboolean   gtk_window_activate_default	       (GtkWindow           *window);
        void       gtk_window_set_transient_for        (GtkWindow           *window, GtkWindow           *parent);
        GtkWindow *gtk_window_get_transient_for        (GtkWindow           *window);
        void       gtk_window_set_attached_to          (GtkWindow           *window, GtkWidget           *attach_widget);
        GtkWidget *gtk_window_get_attached_to          (GtkWindow           *window);
        //GDK_DEPRECATED_IN_3_8_FOR(gtk_widget_set_opacity)
        void       gtk_window_set_opacity              (GtkWindow           *window, gdouble              opacity);
        //GDK_DEPRECATED_IN_3_8_FOR(gtk_widget_get_opacity)
        gdouble    gtk_window_get_opacity              (GtkWindow           *window);
        void       gtk_window_set_type_hint            (GtkWindow           *window, GdkWindowTypeHint    hint);
        GdkWindowTypeHint gtk_window_get_type_hint     (GtkWindow           *window);
        void       gtk_window_set_skip_taskbar_hint    (GtkWindow           *window, gboolean             setting);
        gboolean   gtk_window_get_skip_taskbar_hint    (GtkWindow           *window);

        void       gtk_window_set_skip_pager_hint      (GtkWindow           *window, gboolean             setting);
        gboolean   gtk_window_get_skip_pager_hint      (GtkWindow           *window);
        void       gtk_window_set_urgency_hint         (GtkWindow           *window, gboolean             setting);
        gboolean   gtk_window_get_urgency_hint         (GtkWindow           *window);
        void       gtk_window_set_accept_focus         (GtkWindow           *window, gboolean             setting);
        gboolean   gtk_window_get_accept_focus         (GtkWindow           *window);
        void       gtk_window_set_focus_on_map         (GtkWindow           *window, gboolean             setting);
        gboolean   gtk_window_get_focus_on_map         (GtkWindow           *window);
        void       gtk_window_set_destroy_with_parent  (GtkWindow           *window, gboolean             setting);
        gboolean   gtk_window_get_destroy_with_parent  (GtkWindow           *window);
        void       gtk_window_set_hide_titlebar_when_maximized (GtkWindow   *window, gboolean     setting);
        gboolean   gtk_window_get_hide_titlebar_when_maximized (GtkWindow   *window);
        void       gtk_window_set_mnemonics_visible    (GtkWindow           *window, gboolean             setting);
        gboolean   gtk_window_get_mnemonics_visible    (GtkWindow           *window);
        void       gtk_window_set_focus_visible        (GtkWindow           *window, gboolean             setting);
        gboolean   gtk_window_get_focus_visible        (GtkWindow           *window);
        void       gtk_window_set_resizable            (GtkWindow           *window, gboolean             resizable);
        gboolean   gtk_window_get_resizable            (GtkWindow           *window);
        void       gtk_window_set_gravity              (GtkWindow           *window, GdkGravity           gravity);
        GdkGravity gtk_window_get_gravity              (GtkWindow           *window);
        void       gtk_window_set_geometry_hints       (GtkWindow           *window, GtkWidget           *geometry_widget, GdkGeometry         *geometry, GdkWindowHints       geom_mask);
        void	   gtk_window_set_screen	       (GtkWindow	    *window, GdkScreen	    *screen);
        GdkScreen* gtk_window_get_screen	       (GtkWindow	    *window);
        gboolean   gtk_window_is_active                (GtkWindow           *window);
        gboolean   gtk_window_has_toplevel_focus       (GtkWindow           *window);
        void       gtk_window_set_decorated            (GtkWindow *window, gboolean   setting);
        gboolean   gtk_window_get_decorated            (GtkWindow *window);
        void       gtk_window_set_deletable            (GtkWindow *window, gboolean   setting);
        gboolean   gtk_window_get_deletable            (GtkWindow *window);
        void       gtk_window_set_icon_list                (GtkWindow  *window, GList      *list);
        GList*     gtk_window_get_icon_list                (GtkWindow  *window);
        void       gtk_window_set_icon                     (GtkWindow  *window, GdkPixbuf  *icon);
        void       gtk_window_set_icon_name                (GtkWindow   *window, const gchar *name);
        gboolean   gtk_window_set_icon_from_file           (GtkWindow   *window, const gchar *filename, GError     **err);
        GdkPixbuf* gtk_window_get_icon                     (GtkWindow  *window);
        const gchar * gtk_window_get_icon_name             (GtkWindow  *window);
        void       gtk_window_set_default_icon_list        (GList      *list);
        GList*     gtk_window_get_default_icon_list        (void);
        void       gtk_window_set_default_icon             (GdkPixbuf  *icon);
        void       gtk_window_set_default_icon_name        (const gchar *name);
        const gchar * gtk_window_get_default_icon_name     (void);
        gboolean   gtk_window_set_default_icon_from_file   (const gchar *filename, GError     **err);
        void       gtk_window_set_auto_startup_notification (gboolean setting);

        // If window is set modal, input will be grabbed when show and released when hide
        void       gtk_window_set_modal      (GtkWindow *window, gboolean   modal);
        gboolean   gtk_window_get_modal      (GtkWindow *window);
        GList*     gtk_window_list_toplevels (void);
        void       gtk_window_set_has_user_ref_count (GtkWindow *window, gboolean   setting);
        void     gtk_window_add_mnemonic          (GtkWindow       *window, guint            keyval, GtkWidget       *target);
        void     gtk_window_remove_mnemonic       (GtkWindow       *window, guint            keyval, GtkWidget       *target);
        gboolean gtk_window_mnemonic_activate     (GtkWindow       *window, guint            keyval, GdkModifierType  modifier);
        void     gtk_window_set_mnemonic_modifier (GtkWindow       *window, GdkModifierType  modifier);
        GdkModifierType gtk_window_get_mnemonic_modifier (GtkWindow *window);
        gboolean gtk_window_activate_key          (GtkWindow        *window, GdkEventKey      *event);
        gboolean gtk_window_propagate_key_event   (GtkWindow        *window, GdkEventKey      *event);
        void     gtk_window_present            (GtkWindow *window);
        void     gtk_window_present_with_time  (GtkWindow *window, guint32    timestamp);
        void     gtk_window_iconify       (GtkWindow *window);
        void     gtk_window_deiconify     (GtkWindow *window);
        void     gtk_window_stick         (GtkWindow *window);
        void     gtk_window_unstick       (GtkWindow *window);
        void     gtk_window_maximize      (GtkWindow *window);
        void     gtk_window_unmaximize    (GtkWindow *window);
        void     gtk_window_fullscreen    (GtkWindow *window);
        void     gtk_window_unfullscreen  (GtkWindow *window);
        void     gtk_window_fullscreen_on_monitor(GtkWindow *window, GdkScreen *screen,gint monitor);
        void     gtk_window_close         (GtkWindow *window);
        void     gtk_window_set_keep_above    (GtkWindow *window, gboolean setting);
        void     gtk_window_set_keep_below    (GtkWindow *window, gboolean setting);
        void    gtk_window_begin_resize_drag (GtkWindow     *window, GdkWindowEdge  edge, gint           button, gint           root_x, gint           root_y, guint32        timestamp);
        void    gtk_window_begin_move_drag   (GtkWindow     *window, gint           button, gint           root_x, gint           root_y, guint32        timestamp);
        // Set initial default size of the window (does not constrain user resize operations)
        void     gtk_window_set_default_size (GtkWindow   *window, gint         width, gint         height);
        void     gtk_window_get_default_size (GtkWindow   *window, gint        *width, gint        *height);
        void     gtk_window_resize           (GtkWindow   *window, gint         width, gint         height);
        void     gtk_window_get_size         (GtkWindow   *window, gint        *width, gint        *height);
        void     gtk_window_move             (GtkWindow   *window, gint         x, gint         y);
        void     gtk_window_get_position     (GtkWindow   *window, gint        *root_x, gint        *root_y);
        gboolean gtk_window_parse_geometry   (GtkWindow   *window, const gchar *geometry);
        //GDK_DEPRECATED_IN_3_20_FOR(gtk_window_set_default_size)
        void gtk_window_set_default_geometry (GtkWindow *window, gint       width, gint       height);
        //GDK_DEPRECATED_IN_3_20_FOR(gtk_window_resize)
        void gtk_window_resize_to_geometry   (GtkWindow *window, gint       width, gint       height);
        GtkWindowGroup *gtk_window_get_group (GtkWindow   *window);
        gboolean gtk_window_has_group        (GtkWindow   *window);
        // Ignore this unless you are writing a GUI builder
        void     gtk_window_reshow_with_initial_size (GtkWindow *window);
        GtkWindowType gtk_window_get_window_type     (GtkWindow     *window);
        GtkApplication *gtk_window_get_application      (GtkWindow          *window);
        void            gtk_window_set_application      (GtkWindow          *window, GtkApplication     *application);
        // Window grips
        void     gtk_window_set_has_resize_grip    (GtkWindow    *window, gboolean      value);
        gboolean gtk_window_get_has_resize_grip    (GtkWindow    *window);
        gboolean gtk_window_resize_grip_is_visible (GtkWindow    *window);
        gboolean gtk_window_get_resize_grip_area   (GtkWindow    *window, GdkRectangle *rect);
        void     gtk_window_set_titlebar           (GtkWindow    *window, GtkWidget    *titlebar);
        GtkWidget *gtk_window_get_titlebar         (GtkWindow    *window);
        gboolean gtk_window_is_maximized           (GtkWindow    *window);
        void     gtk_window_set_interactive_debugging (gboolean enable);
        */

        GtkWindow* Impl()
        {
            return m_gtk;
        }

    private:

        ::_GtkWindow* m_gtk;
        ::_GtkWindowClass* m_gtkClass;

    };
}}}//qor::nslinux::gui

#endif//QOR_PP_H_OS_LINUX_GUI_GTK_WINDOW
