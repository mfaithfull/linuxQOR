// Copyright Querysoft Limited 2008 - 2025
//
// Permission is hereby granted, free of charge, to any person or organization
// obtaining a copy of the software and accompanying documentation covered by
// this license (the "Software") to use, reproduce, display, distribute,
// execute, and transmit the Software, and to prepare derivative works of the
// Software, and to permit third-parties to whom the Software is furnished to
// do so, all subject to the following:
// 
// The copyright notices in the Software and this entire statement, including
// the above license grant, this restriction and the following disclaimer,
// must be included in all copies of the Software, in whole or in part, and
// all derivative works of the Software, unless such copies or derivative
// works are solely in the form of machine-executable object code generated by
// a source language processor.
// 
// THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
// IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
// FITNESS FOR A PARTICULAR PURPOSE, TITLE AND NON-INFRINGEMENT. IN NO EVENT
// SHALL THE COPYRIGHT HOLDERS OR ANYONE DISTRIBUTING THE SOFTWARE BE LIABLE
// FOR ANY DAMAGES OR OTHER LIABILITY, WHETHER IN CONTRACT, TORT OR OTHERWISE,
// ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER
// DEALINGS IN THE SOFTWARE.

#include "src/configuration/configuration.h"
#include "src/qor/module/module.h"
#include "src/qor/interception/functioncontext.h"
#include "src/qor/error/error.h"

//Windows specific headers must be last to prevent contaminating generic headers with Windows specific types and definitions
#include "user32.h"
#include "../returncheck.h"
#include "../library.h"

namespace qor { namespace nswindows { namespace api {

    HKL User32::ActivateKeyboardLayout(HKL hkl, UINT Flags)
    {
        qor_pp_fcontext;
        qor_pp_useswinapi(user32, ActivateKeyboardLayout);
        return Library::Call< HKL, HKL, UINT >(pFunc, hkl, Flags);
    }

    BOOL User32::BlockInput(BOOL fBlockIt)
    {
        qor_pp_fcontext;
        qor_pp_useswinapi(user32, BlockInput);
        return Library::Call< BOOL, BOOL >(pFunc, fBlockIt);
    }

    BOOL User32::EnableWindow(HWND hWnd, BOOL bEnable)
    {
        qor_pp_fcontext;
        qor_pp_useswinapi(user32, EnableWindow);
        return Library::Call< BOOL, HWND, BOOL >(pFunc, hWnd, bEnable);
    }

    HWND User32::GetActiveWindow(void)
    {
        qor_pp_fcontext;
        qor_pp_useswinapi(user32, GetActiveWindow);
        return Library::Call< HWND >(pFunc);
    }

    SHORT User32::GetAsyncKeyState(int vKey)
    {
        qor_pp_fcontext;
        qor_pp_useswinapi(user32, GetAsyncKeyState);
        return Library::Call< SHORT, int >(pFunc, vKey );
    }

    HWND User32::GetFocus(void)
    {
        qor_pp_fcontext;
        qor_pp_useswinapi(user32, GetFocus);
        return Library::Call< HWND >(pFunc );
    }

    UINT User32::GetKBCodePage()
    {
        qor_pp_fcontext;
        qor_pp_useswinapi(user32, GetKBCodePage);
        return Library::Call< UINT >(pFunc );
    }

    HKL User32::GetKeyboardLayout(DWORD idThread)
    {
        qor_pp_fcontext;
        qor_pp_useswinapi(user32, GetKeyboardLayout);
        return Library::Call< HKL >(pFunc, idThread );
    }

    UINT User32::GetKeyboardLayoutList(int nBuff, HKL* lpList)
    {
        qor_pp_fcontext;
        qor_pp_useswinapi(user32, GetKeyboardLayoutList);
        return Library::Call< UINT >(pFunc, nBuff, lpList);
    }

    BOOL User32::GetKeyboardLayoutNameT(LPTSTR pwszKLID)
    {
        qor_pp_fcontext;
        qor_pp_useswinapi(user32, GetKeyboardLayoutNameT);
        return Library::Call< BOOL, LPTSTR >(pFunc, pwszKLID);
    }

    BOOL User32::GetKeyboardState(PBYTE lpKeyState)
    {
        qor_pp_fcontext;
        qor_pp_useswinapi(user32, GetKeyboardState);
        return Library::Call< BOOL, PBYTE >(pFunc, lpKeyState);
    }

    int User32::GetKeyboardType(int nTypeFlag)
    {
        qor_pp_fcontext;
        qor_pp_useswinapi(user32, GetKeyboardType);
        return Library::Call< int, int >(pFunc, nTypeFlag );
    }

    int User32::GetKeyNameTextT(LONG lParam, LPTSTR lpString, int nSize)
    {
        qor_pp_fcontext;
        qor_pp_useswinapiAW(user32, GetKeyNameText);
        return Library::Call< int, LONG, LPTSTR, int >(pFunc, lParam, lpString, nSize);
    }

    SHORT User32::GetKeyState(int nVirtKey)
    {
        qor_pp_fcontext;
        qor_pp_useswinapi(user32, GetKeyState);
        return Library::Call< SHORT, int >(pFunc, nVirtKey);
    }

    BOOL User32::GetLastInputInfo(PLASTINPUTINFO plii)
    {
        qor_pp_fcontext;
        qor_pp_useswinapi(user32, GetLastInputInfo);
        return Library::Call< BOOL, PLASTINPUTINFO >(pFunc, plii);
    }

    BOOL User32::IsWindowEnabled(HWND hWnd)
    {
        qor_pp_fcontext;
        qor_pp_useswinapi(user32, IsWindowEnabled);
        return Library::Call< BOOL, HWND >(pFunc, hWnd);
    }

    VOID User32::keybd_event(BYTE bVk, BYTE bScan, DWORD dwFlags, void* dwExtraInfo)
    {
        qor_pp_fcontext;
        qor_pp_useswinapi(user32, keybd_event);
        return Library::voidCall< BYTE, BYTE, DWORD, void* >(pFunc, bVk, bScan, dwFlags, dwExtraInfo);
    }

    HKL User32::LoadKeyboardLayoutT(LPCTSTR pwszKLID, UINT Flags)
    {
        qor_pp_fcontext;
        qor_pp_useswinapiAW(user32, LoadKeyboardLayout);
        return Library::Call< HKL, LPCTSTR, UINT >(pFunc, pwszKLID, Flags);
    }

    UINT User32::MapVirtualKeyT(UINT uCode, UINT uMapType)
    {
        qor_pp_fcontext;
        qor_pp_useswinapiAW(user32, MapVirtualKey);
        return Library::Call< UINT, UINT, UINT >(pFunc, uCode, uMapType);
    }

    UINT User32::MapVirtualKeyExT(UINT uCode, UINT uMapType, HKL dwhkl)
    {
        qor_pp_fcontext;
        qor_pp_useswinapiAW(user32, MapVirtualKeyEx);
        return Library::Call< UINT, UINT, UINT, HKL >(pFunc, uCode, uMapType, dwhkl);
    }

    DWORD User32::OemKeyScan(WORD wOemChar)
    {
        qor_pp_fcontext;
        qor_pp_useswinapi(user32, OemKeyScan);
        return Library::Call< DWORD, WORD >(pFunc, wOemChar );
    }

    BOOL User32::RegisterHotKey(HWND hWnd, int id, UINT fsModifiers, UINT vk)
    {
        qor_pp_fcontext;
        qor_pp_useswinapi(user32, RegisterHotKey);
        return Library::Call< BOOL, HWND, int, UINT, UINT >(pFunc, hWnd, id, fsModifiers, vk );
    }

    UINT User32::SendInput(UINT nInputs, LPINPUT pInputs, int cbSize)
    {
        qor_pp_fcontext;
        qor_pp_useswinapi(user32, SendInput);
        return Library::Call< UINT, UINT, LPINPUT, int >(pFunc, nInputs, pInputs, cbSize);
    }

    HWND User32::SetActiveWindow(HWND hWnd)
    {
        qor_pp_fcontext;
        qor_pp_useswinapi(user32, SetActiveWindow);
        return Library::Call< HWND, HWND >(pFunc, hWnd);
    }

    HWND User32::SetFocus(HWND hWnd)
    {
        qor_pp_fcontext;
        qor_pp_useswinapi(user32, SetFocus);
        return Library::Call< HWND, HWND >(pFunc, hWnd);
    }

    BOOL User32::SetKeyboardState(LPBYTE lpKeyState)
    {
        qor_pp_fcontext;
        qor_pp_useswinapi(user32, SetKeyboardState);
        return Library::Call< BOOL, LPBYTE >(pFunc, lpKeyState);
    }

    int User32::ToAscii(UINT uVirtKey, UINT uScanCode, PBYTE lpKeyState, LPWORD lpChar, UINT uFlags)
    {
        qor_pp_fcontext;
        qor_pp_useswinapi(user32, ToAscii);
        return Library::Call< int, UINT, UINT, PBYTE, LPWORD, UINT >(pFunc, uVirtKey, uScanCode, lpKeyState, lpChar, uFlags);
    }

    int User32::ToAsciiEx(UINT uVirtKey, UINT uScanCode, PBYTE lpKeyState, LPWORD lpChar, UINT uFlags, HKL dwhkl)
    {
        qor_pp_fcontext;
        qor_pp_useswinapi(user32, ToAsciiEx);
        return Library::Call< int, UINT, UINT, PBYTE, LPWORD, UINT, HKL >(pFunc, uVirtKey, uScanCode, lpKeyState, lpChar, uFlags, dwhkl);
    }

    int User32::ToUnicode(UINT wVirtKey, UINT wScanCode, const PBYTE lpKeyState, LPWSTR pwszBuff, int cchBuff, UINT wFlags)
    {
        qor_pp_fcontext;
        qor_pp_useswinapi(user32, ToUnicode);
        return Library::Call< int, UINT, UINT, const PBYTE, LPWSTR, int, UINT >(pFunc, wVirtKey, wScanCode, lpKeyState, pwszBuff, cchBuff, wFlags);
    }

    int User32::ToUnicodeEx(UINT wVirtKey, UINT wScanCode, const PBYTE lpKeyState, LPWSTR pwszBuff, int cchBuff, UINT wFlags, HKL dwhkl)
    {
        qor_pp_fcontext;
        qor_pp_useswinapi(user32, ToUnicodeEx);
        return Library::Call< int, UINT, UINT, const PBYTE, LPWSTR, int, UINT, HKL >(pFunc, wVirtKey, wScanCode, lpKeyState, pwszBuff, cchBuff, wFlags, dwhkl);
    }

    BOOL User32::UnloadKeyboardLayout(HKL hkl)
    {
        qor_pp_fcontext;
        qor_pp_useswinapi(user32, UnloadKeyboardLayout);
        return Library::Call< BOOL, HKL >(pFunc, hkl);
    }

    BOOL User32::UnregisterHotKey(HWND hWnd, int id)
    {
        qor_pp_fcontext;
        qor_pp_useswinapi(user32, UnregisterHotKey);
        return Library::Call< BOOL, HWND, int >(pFunc, hWnd, id);
    }

    SHORT User32::VkKeyScanT(TCHAR ch)
    {
        qor_pp_fcontext;
        qor_pp_useswinapi(user32, VkKeyScanT);
        return Library::Call< SHORT, TCHAR >(pFunc, ch);
    }

    SHORT User32::VkKeyScanExT(TCHAR ch, HKL dwhkl)
    {
        qor_pp_fcontext;
        qor_pp_useswinapi(user32, VkKeyScanExT);
        return Library::Call< SHORT, TCHAR, HKL >(pFunc, ch, dwhkl);
    }

}}}//qor::nswindows::api

