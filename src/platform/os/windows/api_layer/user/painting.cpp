// Copyright Querysoft Limited 2008 - 2025
//
// Permission is hereby granted, free of charge, to any person or organization
// obtaining a copy of the software and accompanying documentation covered by
// this license (the "Software") to use, reproduce, display, distribute,
// execute, and transmit the Software, and to prepare derivative works of the
// Software, and to permit third-parties to whom the Software is furnished to
// do so, all subject to the following:
// 
// The copyright notices in the Software and this entire statement, including
// the above license grant, this restriction and the following disclaimer,
// must be included in all copies of the Software, in whole or in part, and
// all derivative works of the Software, unless such copies or derivative
// works are solely in the form of machine-executable object code generated by
// a source language processor.
// 
// THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
// IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
// FITNESS FOR A PARTICULAR PURPOSE, TITLE AND NON-INFRINGEMENT. IN NO EVENT
// SHALL THE COPYRIGHT HOLDERS OR ANYONE DISTRIBUTING THE SOFTWARE BE LIABLE
// FOR ANY DAMAGES OR OTHER LIABILITY, WHETHER IN CONTRACT, TORT OR OTHERWISE,
// ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER
// DEALINGS IN THE SOFTWARE.

#include "src/configuration/configuration.h"
#include "src/qor/module/module.h"
#include "src/qor/interception/functioncontext.h"
#include "src/qor/error/error.h"

//Windows specific headers must be last to prevent contaminating generic headers with Windows specific types and definitions
#include "user32.h"
#include "../returncheck.h"
#include "../library.h"

namespace qor { namespace nswindows { namespace api {

    HDC User32::BeginPaint(HWND hwnd, ::LPPAINTSTRUCT lpPaint)
    {
        qor_pp_fcontext;
        qor_pp_useswinapi(user32, BeginPaint);
        return Library::Call<HDC, HWND, ::LPPAINTSTRUCT>(pFunc, hwnd, lpPaint);
    }

    BOOL User32::DrawAnimatedRects(HWND hwnd, int idAni, CONST::RECT* lprcFrom, CONST::RECT* lprcTo)
    {
        qor_pp_fcontext;
        qor_pp_useswinapi(user32, DrawAnimatedRects);
        return Library::Call<BOOL, HWND, int, CONST ::RECT*, CONST ::RECT*>(pFunc, hwnd, idAni, lprcFrom, lprcTo);
    }

    BOOL User32::DrawCaption(HWND hwnd, HDC hdc, ::LPCRECT lprc, UINT uFlags)
    {
        qor_pp_fcontext;
        qor_pp_useswinapi(user32, DrawCaption);
        return Library::Call<BOOL, HWND, HDC, ::LPCRECT, UINT>(pFunc, hwnd, hdc, lprc, uFlags);
    }

    BOOL User32::DrawEdge(HDC hdc, ::LPRECT qrc, UINT edge, UINT grfFlags)
    {
        qor_pp_fcontext;
        qor_pp_useswinapi(user32, DrawEdge);
        return Library::Call<BOOL, HDC, ::LPRECT, UINT, UINT>(pFunc, hdc, qrc, edge, grfFlags);
    }

    BOOL User32::DrawFocusRect(HDC hDC, CONST::RECT* lprc)
    {
        qor_pp_fcontext;
        qor_pp_useswinapi(user32, DrawFocusRect);
        return Library::Call<BOOL, HDC, CONST ::RECT*>(pFunc, hDC, lprc);
    }

    BOOL User32::DrawFrameControl(HDC hdc, ::LPRECT lprc, UINT uType, UINT uState)
    {
        qor_pp_fcontext;
        qor_pp_useswinapi(user32, DrawFrameControl);
        return Library::Call<BOOL, HDC, ::LPRECT, UINT, UINT>(pFunc, hdc, lprc, uType, uState);
    }

    BOOL User32::DrawStateT(HDC hdc, HBRUSH hbr, ::DRAWSTATEPROC lpOutputFunc, LPARAM lData, WPARAM wData, int x, int y, int cx, int cy, UINT fuFlags)
    {
        qor_pp_fcontext;
        qor_pp_useswinapiAW(user32, DrawState);
        return Library::Call<BOOL, HDC, HBRUSH, DRAWSTATEPROC, LPARAM, WPARAM, int, int, int, int, UINT>(pFunc, hdc, hbr, lpOutputFunc, lData, wData, x, y, cx, cy, fuFlags);
    }

    BOOL User32::EndPaint(HWND hWnd, CONST::PAINTSTRUCT* lpPaint)
    {
        qor_pp_fcontext;
        qor_pp_useswinapi(user32, EndPaint);
        return Library::Call<BOOL, HWND, CONST ::PAINTSTRUCT*>(pFunc, hWnd, lpPaint);
    }

    int User32::ExcludeUpdateRgn(HDC hDC, HWND hWnd)
    {
        qor_pp_fcontext;
        qor_pp_useswinapi(user32, ExcludeUpdateRgn);
        return Library::Call<int, HDC, HWND>(pFunc, hDC, hWnd);
    }

    BOOL User32::GetUpdateRect(HWND hWnd, ::LPRECT lpRect, BOOL bErase)
    {
        qor_pp_fcontext;
        qor_pp_useswinapi(user32, GetUpdateRect);
        return Library::Call<BOOL, HWND, ::LPRECT, BOOL>(pFunc,hWnd,lpRect,bErase);
    }

    int User32::GetUpdateRgn(HWND hWnd, HRGN hRgn, BOOL bErase)
    {
        qor_pp_fcontext;
        qor_pp_useswinapi(user32, GetUpdateRgn);
        return Library::Call<int, HWND, HRGN, BOOL>(pFunc, hWnd, hRgn, bErase);
    }

    HDC User32::GetWindowDC(HWND hWnd)
    {
        qor_pp_fcontext;
        qor_pp_useswinapi(user32, GetWindowDC);
        return Library::Call<HDC, HWND>(pFunc, hWnd);
    }

    int User32::GetWindowRgn(HWND hWnd, HRGN hRgn)
    {
        qor_pp_fcontext;
        qor_pp_useswinapi(user32, GetWindowRgn);
        return Library::Call<int, HWND, HRGN>(pFunc, hWnd, hRgn);
    }

    int User32::GetWindowRgnBox(HWND hWnd, ::LPRECT lprc)
    {
        qor_pp_fcontext;
        qor_pp_useswinapi(user32, GetWindowRgnBox);
        return Library::Call<int, HWND, ::LPRECT>(pFunc, hWnd, lprc);
    }

    BOOL User32::GrayStringT(HDC hDC, HBRUSH hBrush, ::GRAYSTRINGPROC lpOutputFunc, LPARAM lpData, int nCount, int X, int Y, int nWidth, int nHeight)
    {
        qor_pp_fcontext;
        qor_pp_useswinapiAW(user32, GrayString);
        return Library::Call<BOOL, HDC, HBRUSH, GRAYSTRINGPROC, LPARAM, int, int, int, int, int>(pFunc, hDC, hBrush, lpOutputFunc, lpData, nCount, X, Y, nWidth, nHeight);
    }

    BOOL User32::InvalidateRect(HWND hWnd, CONST::RECT* lpRect, BOOL bErase)
    {
        qor_pp_fcontext;
        qor_pp_useswinapi(user32, InvalidateRect);
        return Library::Call<BOOL, HWND, CONST ::RECT*, BOOL>(pFunc, hWnd, lpRect, bErase);
    }

    BOOL User32::InvalidateRgn(HWND hWnd, HRGN hRgn, BOOL bErase)
    {
        qor_pp_fcontext;
        qor_pp_useswinapi(user32, InvalidateRgn);
        return Library::Call<BOOL, HWND, HRGN, BOOL>(pFunc, hWnd, hRgn, bErase);
    }

    BOOL User32::LockWindowUpdate(HWND hWndLock)
    {
        qor_pp_fcontext;
        qor_pp_useswinapi(user32, LockWindowUpdate);
        return Library::Call<BOOL, HWND>(pFunc, hWndLock);
    }

    BOOL User32::PaintDesktop(HDC hdc)
    {
        qor_pp_fcontext;
        qor_pp_useswinapi(user32, PaintDesktop);
        return Library::Call<BOOL, HDC>(pFunc, hdc);
    }

    BOOL User32::RedrawWindow(HWND hWnd, CONST::RECT* lprcUpdate, HRGN hrgnUpdate, UINT flags)
    {
        qor_pp_fcontext;
        qor_pp_useswinapi(user32, RedrawWindow);
        return Library::Call<BOOL, HWND, CONST ::RECT*, HRGN, UINT>(pFunc, hWnd, lprcUpdate, hrgnUpdate, flags);
    }

    int User32::SetWindowRgn(HWND hWnd, HRGN hRgn, BOOL bRedraw)
    {
        qor_pp_fcontext;
        qor_pp_useswinapi(user32, SetWindowRgn);
        return Library::Call<int, HWND, HRGN, BOOL>(pFunc, hWnd, hRgn, bRedraw);
    }

    BOOL User32::UpdateWindow(HWND hWnd)
    {
        qor_pp_fcontext;
        qor_pp_useswinapi(user32, UpdateWindow);
        return Library::Call<BOOL, HWND>(pFunc, hWnd);
    }

    BOOL User32::ValidateRect(HWND hWnd, CONST::RECT* lpRect)
    {
        qor_pp_fcontext;
        qor_pp_useswinapi(user32, ValidateRect);
        return Library::Call<BOOL, HWND, CONST ::RECT*>(pFunc, hWnd, lpRect );
    }

    BOOL User32::ValidateRgn(HWND hWnd, HRGN hRgn)
    {
        qor_pp_fcontext;
        qor_pp_useswinapi(user32, ValidateRgn);
        return Library::Call<BOOL, HWND, HRGN>(pFunc, hWnd, hRgn);
    }

    HWND User32::WindowFromDC(HDC hDC)
    {
        qor_pp_fcontext;
        qor_pp_useswinapi(user32, WindowFromDC);
        return Library::Call<HWND, HDC>(pFunc, hDC);
    }

}}}//qor::nswindows::api