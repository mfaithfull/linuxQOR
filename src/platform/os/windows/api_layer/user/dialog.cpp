// Copyright Querysoft Limited 2008 - 2025
//
// Permission is hereby granted, free of charge, to any person or organization
// obtaining a copy of the software and accompanying documentation covered by
// this license (the "Software") to use, reproduce, display, distribute,
// execute, and transmit the Software, and to prepare derivative works of the
// Software, and to permit third-parties to whom the Software is furnished to
// do so, all subject to the following:
// 
// The copyright notices in the Software and this entire statement, including
// the above license grant, this restriction and the following disclaimer,
// must be included in all copies of the Software, in whole or in part, and
// all derivative works of the Software, unless such copies or derivative
// works are solely in the form of machine-executable object code generated by
// a source language processor.
// 
// THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
// IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
// FITNESS FOR A PARTICULAR PURPOSE, TITLE AND NON-INFRINGEMENT. IN NO EVENT
// SHALL THE COPYRIGHT HOLDERS OR ANYONE DISTRIBUTING THE SOFTWARE BE LIABLE
// FOR ANY DAMAGES OR OTHER LIABILITY, WHETHER IN CONTRACT, TORT OR OTHERWISE,
// ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER
// DEALINGS IN THE SOFTWARE.

#include "src/configuration/configuration.h"
#include "src/qor/module/module.h"
#include "src/qor/interception/functioncontext.h"
#include "src/qor/error/error.h"

//Windows specific headers must be last to prevent contaminating generic headers with Windows specific types and definitions
#include "user32.h"
#include "../returncheck.h"
#include "../library.h"

namespace qor { namespace nswindows { namespace api {

    HWND User32::CreateDialogIndirectParamT(HINSTANCE hInstance, LPCDLGTEMPLATE lpTemplate, HWND hWndParent, ::DLGPROC lpDialogFunc, LPARAM lParamInit)
    {
        qor_pp_fcontext;
        qor_pp_useswinapiAW(user32, CreateDialogIndirectParam);
        return Library::Call<HWND, HINSTANCE, LPCDLGTEMPLATE, HWND, DLGPROC, LPARAM>(pFunc, hInstance, lpTemplate, hWndParent, lpDialogFunc, lParamInit);
    }

    HWND User32::CreateDialogParamT(HINSTANCE hInstance, LPCTSTR lpTemplateName, HWND hWndParent, ::DLGPROC lpDialogFunc, LPARAM dwInitParam)
    {
        qor_pp_fcontext;
        qor_pp_useswinapiAW(user32, CreateDialogParam);
        return Library::Call<HWND, HINSTANCE, LPCTSTR, HWND, DLGPROC, LPARAM>(pFunc, hInstance, lpTemplateName, hWndParent, lpDialogFunc, dwInitParam);
    }

    LRESULT User32::DefDlgProcT(HWND hDlg, UINT Msg, WPARAM wParam, LPARAM lParam)
    {
        qor_pp_fcontext;
        qor_pp_useswinapiAW(user32, DefDlgProc);
        return Library::Call<LRESULT, HWND, UINT, WPARAM, LPARAM>(pFunc, hDlg, Msg, wParam, lParam);
    }

    INT_PTR User32::DialogBoxIndirectParamT(HINSTANCE hInstance, LPCDLGTEMPLATE hDialogTemplate, HWND hWndParent, ::DLGPROC lpDialogFunc, LPARAM dwInitParam)
    {
        qor_pp_fcontext;
        qor_pp_useswinapiAW(user32, DialogBoxIndirectParam);
        return Library::Call<INT_PTR, HINSTANCE, LPCDLGTEMPLATE, HWND, ::DLGPROC, LPARAM>(pFunc, hInstance, hDialogTemplate, hWndParent, lpDialogFunc, dwInitParam);
    }

    INT_PTR User32::DialogBoxParamT(HINSTANCE hInstance, LPCTSTR lpTemplateName, HWND hWndParent, ::DLGPROC lpDialogFunc, LPARAM dwInitParam)
    {
        qor_pp_fcontext;
        qor_pp_useswinapiAW(user32, DialogBoxParam);
        return Library::Call<INT_PTR, HINSTANCE, LPCTSTR, HWND, DLGPROC, LPARAM>(pFunc, hInstance, lpTemplateName, hWndParent, lpDialogFunc, dwInitParam);
    }

    BOOL User32::EndDialog(HWND hDlg, INT_PTR nResult)
    {
        qor_pp_fcontext;
        qor_pp_useswinapi(user32, EndDialog);
        return Library::Call<BOOL, HWND, INT_PTR>(pFunc, hDlg, nResult);
    }

    LONG User32::GetDialogBaseUnits(void)
    {
        qor_pp_fcontext;
        qor_pp_useswinapi(user32, GetDialogBaseUnits);
        return Library::Call<LONG>(pFunc);
    }

    int User32::GetDlgCtrlID(HWND hwndCtl)
    {
        qor_pp_fcontext;
        qor_pp_useswinapi(user32, GetDlgCtrlID);
        return Library::Call<int, HWND>(pFunc, hwndCtl);
    }

    HWND User32::GetDlgItem(HWND hDlg, int nIDDlgItem)
    {
        qor_pp_fcontext;
        qor_pp_useswinapi(user32, GetDlgItem);
        return Library::Call<HWND, HWND, int>(pFunc, hDlg, nIDDlgItem);
    }

    UINT User32::GetDlgItemInt(HWND hDlg, int nIDDlgItem, BOOL* lpTranslated, BOOL bSigned)
    {
        qor_pp_fcontext;
        qor_pp_useswinapi(user32, GetDlgItemInt);
        return Library::Call<UINT, HWND, int, BOOL*, BOOL>(pFunc, hDlg, nIDDlgItem, lpTranslated, bSigned);
    }

    UINT User32::GetDlgItemTextT(HWND hDlg, int nIDDlgItem, LPTSTR lpString, int nMaxCount)
    {
        qor_pp_fcontext;
        qor_pp_useswinapi(user32, GetDlgItemTextT);
        return Library::Call<UINT, HWND, int, LPTSTR, int>(pFunc, hDlg, nIDDlgItem, lpString, nMaxCount);
    }

    HWND User32::GetNextDlgGroupItem(HWND hDlg, HWND hCtl, BOOL bPrevious)
    {
        qor_pp_fcontext;
        qor_pp_useswinapi(user32, GetNextDlgGroupItem);
        return Library::Call<HWND, HWND, HWND, BOOL>(pFunc, hDlg, hCtl, bPrevious);
    }

    HWND User32::GetNextDlgTabItem(HWND hDlg, HWND hCtl, BOOL bPrevious)
    {
        qor_pp_fcontext;
        qor_pp_useswinapi(user32, GetNextDlgTabItem);
        return Library::Call<HWND, HWND, HWND, BOOL>(pFunc, hDlg, hCtl, bPrevious);
    }

    BOOL User32::IsDialogMessageT(HWND hDlg, LPMSG lpMsg)
    {
        qor_pp_fcontext;
        qor_pp_useswinapiAW(user32, IsDialogMessage);
        return Library::Call<BOOL, HWND, LPMSG>(pFunc, hDlg, lpMsg);
    }

    BOOL User32::MapDialogRect(HWND hDlg, LPRECT lpRect)
    {
        qor_pp_fcontext;
        qor_pp_useswinapi(user32, MapDialogRect);
        return Library::Call<BOOL, HWND, LPRECT>(pFunc, hDlg, lpRect);
    }

    int User32::MessageBoxT(HWND hWnd, LPCTSTR lpText, LPCTSTR lpCaption, UINT uType)
    {
        qor_pp_fcontext;
        qor_pp_useswinapi(user32, MessageBox);
        return Library::Call<int, HWND, LPCTSTR, LPCTSTR, UINT>(pFunc, hWnd, lpText, lpCaption, uType);
    }

    int User32::MessageBoxExT(HWND hWnd, LPCTSTR lpText, LPCTSTR lpCaption, UINT uType, WORD wLanguageId)
    {
        qor_pp_fcontext;
        qor_pp_useswinapiAW(user32, MessageBoxEx);
        return Library::Call<int, HWND, LPCTSTR, LPCTSTR, UINT, WORD>(pFunc, hWnd, lpText, lpCaption, uType, wLanguageId);
    }

    int User32::MessageBoxIndirectT(const ::LPMSGBOXPARAMS lpMsgBoxParams)
    {
        qor_pp_fcontext;
        qor_pp_useswinapiAW(user32, MessageBoxIndirect);
        return Library::Call<int, const ::LPMSGBOXPARAMS>(pFunc, lpMsgBoxParams);
    }

    //NOTE: Thanks to CPian Maurizio Pisano
    int User32::MessageBoxTimeout(HWND hWnd, LPCTSTR lpText, LPCTSTR lpCaption, UINT uType, WORD wLanguageId, DWORD dwMilliseconds)
    {
        qor_pp_fcontext;
        qor_pp_useswinapi(user32, MessageBoxTimeout);
        return Library::Call<int, HWND, LPCTSTR, LPCTSTR, UINT, WORD, DWORD>(pFunc, hWnd, lpText, lpCaption, uType, wLanguageId, dwMilliseconds);
    }

    LRESULT User32::SendDlgItemMessageT(HWND hDlg, int nIDDlgItem, UINT Msg, WPARAM wParam, LPARAM lParam)
    {
        qor_pp_fcontext;
        qor_pp_useswinapiAW(user32, SendDlgItemMessage);
        return Library::Call<LRESULT, HWND, int, UINT, WPARAM, LPARAM>(pFunc, hDlg, nIDDlgItem, Msg, wParam, lParam);
    }

    BOOL User32::SetDlgItemInt(HWND hDlg, int nIDDlgItem, UINT uValue, BOOL bSigned)
    {
        qor_pp_fcontext;
        qor_pp_useswinapi(user32, SetDlgItemInt);
        return Library::Call<BOOL, HWND, int, UINT, BOOL>(pFunc, hDlg, nIDDlgItem, uValue, bSigned);
    }

    BOOL User32::SetDlgItemTextT(HWND hDlg, int nIDDlgItem, LPCTSTR lpString)
    {
        qor_pp_fcontext;
        qor_pp_useswinapiAW(user32, SetDlgItemText);
        return Library::Call<BOOL, HWND, int, LPCTSTR>(pFunc, hDlg, nIDDlgItem, lpString);
    }

}}}//qor::nswindows::api
