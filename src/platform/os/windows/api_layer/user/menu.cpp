// Copyright Querysoft Limited 2008 - 2025
//
// Permission is hereby granted, free of charge, to any person or organization
// obtaining a copy of the software and accompanying documentation covered by
// this license (the "Software") to use, reproduce, display, distribute,
// execute, and transmit the Software, and to prepare derivative works of the
// Software, and to permit third-parties to whom the Software is furnished to
// do so, all subject to the following:
// 
// The copyright notices in the Software and this entire statement, including
// the above license grant, this restriction and the following disclaimer,
// must be included in all copies of the Software, in whole or in part, and
// all derivative works of the Software, unless such copies or derivative
// works are solely in the form of machine-executable object code generated by
// a source language processor.
// 
// THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
// IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
// FITNESS FOR A PARTICULAR PURPOSE, TITLE AND NON-INFRINGEMENT. IN NO EVENT
// SHALL THE COPYRIGHT HOLDERS OR ANYONE DISTRIBUTING THE SOFTWARE BE LIABLE
// FOR ANY DAMAGES OR OTHER LIABILITY, WHETHER IN CONTRACT, TORT OR OTHERWISE,
// ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER
// DEALINGS IN THE SOFTWARE.

#include "src/configuration/configuration.h"
#include "src/qor/module/module.h"
#include "src/qor/interception/functioncontext.h"
#include "src/qor/error/error.h"

//Windows specific headers must be last to prevent contaminating generic headers with Windows specific types and definitions
#include "user32.h"
#include "../returncheck.h"
#include "../library.h"

namespace qor { namespace nswindows { namespace api {

    BOOL User32::AppendMenuT(HMENU hMenu, UINT uFlags, UINT_PTR uIDNewItem, LPCTSTR lpNewItem)
    {
        qor_pp_fcontext;
        qor_pp_useswinapiAW(user32, AppendMenu);
        return Library::Call<BOOL, HMENU, UINT, UINT_PTR, LPCTSTR>(pFunc, hMenu, uFlags, uIDNewItem, lpNewItem);
    }

    DWORD User32::CheckMenuItem(HMENU hmenu, UINT uIDCheckItem, UINT uCheck)
    {
        qor_pp_fcontext;
        qor_pp_useswinapi(user32, CheckMenuItem);
        return Library::Call<DWORD, HMENU, UINT, UINT>(pFunc, hmenu, uIDCheckItem, uCheck);
    }

    BOOL User32::CheckMenuRadioItem(HMENU hmenu, UINT idFirst, UINT idLast, UINT idCheck, UINT uFlags)
    {
        qor_pp_fcontext;
        qor_pp_useswinapi(user32, CheckMenuRadioItem);
        return Library::Call<BOOL, HMENU, UINT, UINT, UINT, UINT>(pFunc, hmenu, idFirst, idLast, idCheck, uFlags);
    }

    HMENU User32::CreateMenu(void)
    {
        qor_pp_fcontext;
        qor_pp_useswinapi(user32, CreateMenu);
        return Library::Call<HMENU>(pFunc);
    }

    HMENU User32::CreatePopupMenu(void)
    {
        qor_pp_fcontext;
        qor_pp_useswinapi(user32, CreatePopupMenu);
        return Library::Call<HMENU>(pFunc);
    }

    BOOL User32::DeleteMenu(HMENU hMenu, UINT uPosition, UINT uFlags)
    {
        qor_pp_fcontext;
        qor_pp_useswinapi(user32, DeleteMenu);
        return Library::Call<BOOL, HMENU, UINT, UINT>(pFunc, hMenu, uPosition, uFlags);
    }

    BOOL User32::DestroyMenu(HMENU hMenu)
    {
        qor_pp_fcontext;
        qor_pp_useswinapi(user32, DestroyMenu);
        return Library::Call<BOOL, HMENU>(pFunc, hMenu);
    }

    BOOL User32::DrawMenuBar(HWND hWnd)
    {
        qor_pp_fcontext;
        qor_pp_useswinapi(user32, DrawMenuBar);
        return Library::Call<BOOL, HWND>(pFunc, hWnd);
    }

    BOOL User32::EnableMenuItem(HMENU hMenu, UINT uIDEnableItem, UINT uEnable)
    {
        qor_pp_fcontext;
        qor_pp_useswinapi(user32, EnableMenuItem);
        return Library::Call<BOOL, HMENU, UINT, UINT>(pFunc, hMenu, uIDEnableItem, uEnable);
    }

    BOOL User32::EndMenu(void)
    {
        qor_pp_fcontext;
        qor_pp_useswinapi(user32, EndMenu);
        return Library::Call<BOOL>(pFunc);
    }

    HMENU User32::GetMenu(HWND hWnd)
    {
        qor_pp_fcontext;
        qor_pp_useswinapi(user32, GetMenu);
        return Library::Call<HMENU, HWND>(pFunc, hWnd);
    }

    BOOL User32::GetMenuBarInfo(HWND hwnd, LONG idObject, LONG idItem, PMENUBARINFO pmbi)
    {
        qor_pp_fcontext;
        qor_pp_useswinapi(user32, GetMenuBarInfo);
        return Library::Call<BOOL, HWND, LONG, LONG, PMENUBARINFO>(pFunc, hwnd, idObject, idItem, pmbi);
    }

    LONG User32::GetMenuCheckMarkDimensions(void)
    {
        qor_pp_fcontext;
        qor_pp_useswinapi(user32, GetMenuCheckMarkDimensions);
        return Library::Call<LONG>(pFunc);
    }

    UINT User32::GetMenuDefaultItem(HMENU hMenu, UINT fByPos, UINT gmdiFlags)
    {
        qor_pp_fcontext;
        qor_pp_useswinapi(user32, GetMenuDefaultItem);
        return Library::Call<UINT, HMENU, UINT, UINT>(pFunc, hMenu, fByPos, gmdiFlags);
    }

    BOOL User32::GetMenuInfo(HMENU hmenu, ::LPCMENUINFO lpcmi)
    {
        qor_pp_fcontext;
        qor_pp_useswinapi(user32, GetMenuInfo);
        return Library::Call<BOOL, HMENU, ::LPCMENUINFO>(pFunc, hmenu, lpcmi);
    }

    int User32::GetMenuItemCount(HMENU hMenu)
    {
        qor_pp_fcontext;
        qor_pp_useswinapi(user32, GetMenuItemCount);
        return Library::Call<int, HMENU>(pFunc, hMenu);
    }

    UINT User32::GetMenuItemID(HMENU hMenu, int nPos)
    {
        qor_pp_fcontext;
        qor_pp_useswinapi(user32, GetMenuItemID);
        return Library::Call<UINT, HMENU, int>(pFunc, hMenu, nPos);
    }

    BOOL User32::GetMenuItemInfoT(HMENU hMenu, UINT uItem, BOOL fByPosition, LPMENUITEMINFO lpmii)
    {
        qor_pp_fcontext;
        qor_pp_useswinapiAW(user32, GetMenuItemInfo);
        return Library::Call<BOOL, HMENU, UINT, BOOL, LPMENUITEMINFO>(pFunc, hMenu, uItem, fByPosition, lpmii);
    }

    BOOL User32::GetMenuItemRect(HWND hWnd, HMENU hMenu, UINT uItem, ::LPRECT lprcItem)
    {
        qor_pp_fcontext;
        qor_pp_useswinapi(user32, GetMenuItemRect);
        return Library::Call<BOOL, HWND, HMENU, UINT, ::LPRECT>(pFunc, hWnd, hMenu, uItem, lprcItem);
    }

    UINT User32::GetMenuState(HMENU hMenu, UINT uId, UINT uFlags)
    {
        qor_pp_fcontext;
        qor_pp_useswinapi(user32, GetMenuState);
        return Library::Call<UINT, HMENU, UINT, UINT>(pFunc, hMenu, uId, uFlags);
    }

    int User32::GetMenuStringT(HMENU hMenu, UINT uIDItem, LPTSTR lpString, int nMaxCount, UINT uFlag)
    {
        qor_pp_fcontext;
        qor_pp_useswinapi(user32, GetMenuString);
        return Library::Call<int, HMENU, UINT, LPTSTR, int, UINT>(pFunc, hMenu, uIDItem, lpString, nMaxCount, uFlag);
    }

    HMENU User32::GetSubMenu(HMENU hMenu, int nPos)
    {
        qor_pp_fcontext;
        qor_pp_useswinapi(user32, GetSubMenu);
        return Library::Call<HMENU, HMENU, int>(pFunc, hMenu, nPos);
    }

    HMENU User32::GetSystemMenu(HWND hWnd, BOOL bRevert)
    {
        qor_pp_fcontext;
        qor_pp_useswinapi(user32, GetSystemMenu);
        return Library::Call<HMENU, HWND, BOOL>(pFunc, hWnd, bRevert);
    }

    BOOL User32::HiliteMenuItem(HWND hwnd, HMENU hmenu, UINT uItemHilite, UINT uHilite)
    {
        qor_pp_fcontext;
        qor_pp_useswinapi(user32, HiliteMenuItem);
        return Library::Call<BOOL, HWND, HMENU, UINT, UINT>(pFunc, hwnd, hmenu, uItemHilite, uHilite);
    }

    BOOL User32::InsertMenuT(HMENU hMenu, UINT uPosition, UINT uFlags, void* uIDNewItem, LPCTSTR lpNewItem)
    {
        qor_pp_fcontext;
        qor_pp_useswinapiAW(user32, InsertMenu);
        return Library::Call<BOOL, HMENU, UINT, UINT, void*, LPCTSTR>(pFunc, hMenu, uPosition, uFlags, uIDNewItem, lpNewItem);
    }

    BOOL User32::InsertMenuItemT(HMENU hMenu, UINT uItem, BOOL fByPosition, LPCMENUITEMINFO lpmii)
    {
        qor_pp_fcontext;
        qor_pp_useswinapi(user32, InsertMenuItem);
        return Library::Call<BOOL, HMENU, UINT, BOOL, LPCMENUITEMINFO>(pFunc, hMenu, uItem, fByPosition, lpmii);
    }

    BOOL User32::IsMenu(HMENU hMenu)
    {
        qor_pp_fcontext;
        qor_pp_useswinapi(user32, IsMenu);
        return Library::Call<BOOL, HMENU>(pFunc, hMenu);
    }

    HMENU User32::LoadMenuT(HINSTANCE hInstance, LPCTSTR lpMenuName)
    {
        qor_pp_fcontext;
        qor_pp_useswinapiAW(user32, LoadMenu);
        return Library::Call<HMENU, HINSTANCE, LPCTSTR>(pFunc, hInstance, lpMenuName);
    }

    HMENU User32::LoadMenuIndirectT(CONST MENUTEMPLATE* lpMenuTemplate)
    {
        qor_pp_fcontext;
        qor_pp_useswinapiAW(user32, LoadMenuIndirect);
        return Library::Call<HMENU, CONST MENUTEMPLATE*>(pFunc, lpMenuTemplate);
    }

    int User32::MenuItemFromPoint(HWND hWnd, HMENU hMenu, POINT ptScreen)
    {
        qor_pp_fcontext;
        qor_pp_useswinapi(user32, MenuItemFromPoint);
        return Library::Call<int, HWND, HMENU, POINT>(pFunc, hWnd, hMenu, ptScreen);
    }

    BOOL User32::ModifyMenuT(HMENU hMenu, UINT uPosition, UINT uFlags, void* uIDNewItem, LPCTSTR lpNewItem)
    {
        qor_pp_fcontext;
        qor_pp_useswinapiAW(user32, ModifyMenu);
        return Library::Call<BOOL, HMENU, UINT, UINT, void*, LPCTSTR>(pFunc, hMenu, uPosition, uFlags, uIDNewItem, lpNewItem);
    }

    BOOL User32::RemoveMenu(HMENU hMenu, UINT uPosition, UINT uFlags)
    {
        qor_pp_fcontext;
        qor_pp_useswinapi(user32, RemoveMenu);
        return Library::Call<BOOL, HMENU, UINT, UINT>(pFunc, hMenu, uPosition, uFlags);
    }

    BOOL User32::SetMenu(HWND hWnd, HMENU hMenu)
    {
        qor_pp_fcontext;
        qor_pp_useswinapi(user32, SetMenu);
        return Library::Call<BOOL, HWND, HMENU>(pFunc, hWnd, hMenu);
    }

    BOOL User32::SetMenuDefaultItem(HMENU hMenu, UINT uItem, UINT fByPos)
    {
        qor_pp_fcontext;
        qor_pp_useswinapi(user32, SetMenuDefaultItem);
        return Library::Call<BOOL, HMENU, UINT, UINT>(pFunc, hMenu, uItem, fByPos);
    }

    BOOL User32::SetMenuInfo(HMENU hmenu, ::LPCMENUINFO lpcmi)
    {
        qor_pp_fcontext;
        qor_pp_useswinapi(user32, SetMenuInfo);
        return Library::Call<BOOL, HMENU, ::LPCMENUINFO>(pFunc, hmenu, lpcmi);
    }

    BOOL User32::SetMenuItemBitmaps(HMENU hMenu, UINT uPosition, UINT uFlags, HBITMAP hBitmapUnchecked, HBITMAP hBitmapChecked)
    {
        qor_pp_fcontext;
        qor_pp_useswinapi(user32, SetMenuItemBitmaps);
        return Library::Call<BOOL, HMENU, UINT, UINT, HBITMAP, HBITMAP>(pFunc, hMenu, uPosition, uFlags, hBitmapUnchecked, hBitmapChecked);
    }

    BOOL User32::SetMenuItemInfoT(HMENU hMenu, UINT uItem, BOOL fByPosition, LPMENUITEMINFO lpmii)
    {
        qor_pp_fcontext;
        qor_pp_useswinapiAW(user32, SetMenuItemInfo);
        return Library::Call<BOOL, HMENU, UINT, BOOL, LPMENUITEMINFO>(pFunc, hMenu, uItem, fByPosition, lpmii);
    }

    BOOL User32::TrackPopupMenu(HMENU hMenu, UINT uFlags, int x, int y, int nReserved, HWND hWnd, HWND prcRect)
    {
        qor_pp_fcontext;
        qor_pp_useswinapi(user32, TrackPopupMenu);
        return Library::Call<BOOL, HMENU, UINT, int, int, int, HWND, HWND>(pFunc, hMenu, uFlags, x, y, nReserved, hWnd, prcRect);
    }

    BOOL User32::TrackPopupMenuEx(HMENU hmenu, UINT fuFlags, int x, int y, HWND hwnd, ::LPTPMPARAMS lptpm)
    {
        qor_pp_fcontext;
        qor_pp_useswinapi(user32, TrackPopupMenuEx);
        return Library::Call<BOOL, HMENU, UINT, int, int, HWND, ::LPTPMPARAMS>(pFunc, hmenu, fuFlags, x, y, hwnd, lptpm);
    }

}}}//qor::nswindows::api
