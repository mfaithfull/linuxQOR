// Copyright Querysoft Limited 2008 - 2025
//
// Permission is hereby granted, free of charge, to any person or organization
// obtaining a copy of the software and accompanying documentation covered by
// this license (the "Software") to use, reproduce, display, distribute,
// execute, and transmit the Software, and to prepare derivative works of the
// Software, and to permit third-parties to whom the Software is furnished to
// do so, all subject to the following:
// 
// The copyright notices in the Software and this entire statement, including
// the above license grant, this restriction and the following disclaimer,
// must be included in all copies of the Software, in whole or in part, and
// all derivative works of the Software, unless such copies or derivative
// works are solely in the form of machine-executable object code generated by
// a source language processor.
// 
// THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
// IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
// FITNESS FOR A PARTICULAR PURPOSE, TITLE AND NON-INFRINGEMENT. IN NO EVENT
// SHALL THE COPYRIGHT HOLDERS OR ANYONE DISTRIBUTING THE SOFTWARE BE LIABLE
// FOR ANY DAMAGES OR OTHER LIABILITY, WHETHER IN CONTRACT, TORT OR OTHERWISE,
// ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER
// DEALINGS IN THE SOFTWARE.

#include "src/configuration/configuration.h"
#include "src/qor/module/module.h"
#include "src/qor/interception/functioncontext.h"
#include "src/qor/error/error.h"

//Windows specific headers must be last to prevent contaminating generic headers with Windows specific types and definitions
#include "user32.h"
#include "../returncheck.h"
#include "../library.h"

namespace qor { namespace nswindows { namespace api {

    BOOL User32::GetClassInfoT(HINSTANCE hInstance, LPCTSTR lpClassName, LPWNDCLASS lpWndClass)
    {
        qor_pp_fcontext;
        qor_pp_useswinapiAW(user32, GetClassInfo);
        return Library::Call< BOOL, HINSTANCE, LPCTSTR, LPWNDCLASS >(pFunc, hInstance, lpClassName, lpWndClass);
    }

    BOOL User32::GetClassInfoExT(HINSTANCE hinst, LPCTSTR lpszClass, LPWNDCLASSEX lpwcx)
    {
        qor_pp_fcontext;
        qor_pp_useswinapiAW(user32, GetClassInfoEx);
        return Library::Call< BOOL, HINSTANCE, LPCTSTR, LPWNDCLASSEX >(pFunc, hinst, lpszClass, lpwcx);
    }

    ULONG_PTR User32::GetClassLongPtrT(HWND hWnd, int nIndex)
    {
        qor_pp_fcontext;
        qor_pp_useswinapiAW(user32, GetClassLongPtr);
        return Library::Call< ULONG_PTR, HWND, int >(pFunc, hWnd, nIndex);
    }

    int User32::GetClassNameT(HWND hWnd, LPTSTR lpClassName, int nMaxCount)
    {
        qor_pp_fcontext;
        qor_pp_useswinapiAW(user32, GetClassName);
        return Library::Call< int, HWND, LPTSTR, int >(pFunc, hWnd, lpClassName, nMaxCount);
    }

    WORD User32::GetClassWord(HWND hWnd, int nIndex)
    {
        qor_pp_fcontext;
        qor_pp_useswinapi(user32, GetClassWord);
        return Library::Call< WORD, HWND, int >(pFunc, hWnd, nIndex);
    }

    LONG User32::GetWindowLongT(HWND hWnd, int nIndex)
    {
        qor_pp_fcontext;
        qor_pp_useswinapiAW(user32, GetWindowLong);
        return Library::Call< LONG, HWND, int >(pFunc, hWnd, nIndex);
    }

    ATOM User32::RegisterClassT(CONST WNDCLASS* lpWndClass)
    {
        qor_pp_fcontext;
        qor_pp_useswinapiAW(user32, RegisterClass);
        return Library::Call< ATOM, CONST WNDCLASS* >(pFunc, lpWndClass);
    }

    ATOM User32::RegisterClassExT(CONST WNDCLASSEX* lpwcx)
    {
        qor_pp_fcontext;
        qor_pp_useswinapiAW(user32, RegisterClassEx);
        return Library::Call< ATOM, CONST WNDCLASSEX* >(pFunc, lpwcx);
    }

    ULONG_PTR User32::SetClassLongPtrT(HWND hWnd, int nIndex, LONG_PTR dwNewLong)
    {
        qor_pp_fcontext;
        qor_pp_useswinapiAW(user32, SetClassLongPtr);
        return Library::Call< ULONG_PTR, HWND, int, LONG_PTR >(pFunc, hWnd, nIndex, dwNewLong);
    }

    WORD User32::SetClassWord(HWND hWnd, int nIndex, WORD wNewWord)
    {
        qor_pp_fcontext;
        qor_pp_useswinapi(user32, SetClassWord);
        return Library::Call< WORD, HWND, int, WORD >(pFunc, hWnd, nIndex, wNewWord);
    }

    LONG User32::SetWindowLongT(HWND hWnd, int nIndex, LONG dwNewLong)
    {
        qor_pp_fcontext;
        qor_pp_useswinapiAW(user32, SetWindowLong);
        return Library::Call< LONG, HWND, int, LONG >(pFunc, hWnd, nIndex, dwNewLong);
    }

    LONG_PTR User32::SetWindowLongPtrT(HWND hWnd, int nIndex, LONG_PTR dwNewLong)
    {
        qor_pp_fcontext;
        qor_pp_useswinapiAW(user32, SetWindowLongPtr);
        return Library::Call< LONG_PTR, HWND, int, LONG_PTR >(pFunc, hWnd, nIndex, dwNewLong);
    }
    
    LONG_PTR User32::GetWindowLongPtrT(HWND hWnd, int nIndex)
    {
        qor_pp_fcontext;
        qor_pp_useswinapiAW(user32, GetWindowLongPtr);
        return Library::Call< LONG_PTR, HWND, int >(pFunc, hWnd, nIndex);
    }

    BOOL User32::UnregisterClassT(LPCTSTR lpClassName, HINSTANCE hInstance)
    {
        qor_pp_fcontext;
        qor_pp_useswinapiAW(user32, UnregisterClass);
        return Library::Call< BOOL, LPCTSTR, HINSTANCE >(pFunc, lpClassName, hInstance);
    }

}}}//qor::nswindows::api

