// Copyright Querysoft Limited 2008 - 2025
//
// Permission is hereby granted, free of charge, to any person or organization
// obtaining a copy of the software and accompanying documentation covered by
// this license (the "Software") to use, reproduce, display, distribute,
// execute, and transmit the Software, and to prepare derivative works of the
// Software, and to permit third-parties to whom the Software is furnished to
// do so, all subject to the following:
// 
// The copyright notices in the Software and this entire statement, including
// the above license grant, this restriction and the following disclaimer,
// must be included in all copies of the Software, in whole or in part, and
// all derivative works of the Software, unless such copies or derivative
// works are solely in the form of machine-executable object code generated by
// a source language processor.
// 
// THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
// IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
// FITNESS FOR A PARTICULAR PURPOSE, TITLE AND NON-INFRINGEMENT. IN NO EVENT
// SHALL THE COPYRIGHT HOLDERS OR ANYONE DISTRIBUTING THE SOFTWARE BE LIABLE
// FOR ANY DAMAGES OR OTHER LIABILITY, WHETHER IN CONTRACT, TORT OR OTHERWISE,
// ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER
// DEALINGS IN THE SOFTWARE.

#include "src/configuration/configuration.h"
#include "src/qor/module/module.h"
#include "src/qor/interception/functioncontext.h"
#include "src/qor/error/error.h"

//Windows specific headers must be last to prevent contaminating generic headers with Windows specific types and definitions
#include "gdi32.h"
#include "../returncheck.h"
#include "../library.h"

namespace qor { namespace nswindows { namespace api {

    HANDLE GDI32::AddFontMemResourceEx(PVOID pbFont, DWORD cbFont, PVOID pdv, DWORD* pcFonts)
    {
        qor_pp_fcontext;
        qor_pp_useswinapi(gdi32, AddFontMemResourceEx);
        return Library::Call< HANDLE, PVOID, DWORD, PVOID, DWORD* >(pFunc, pbFont, cbFont, pdv, pcFonts);
    }

    int GDI32::AddFontResourceT(LPCTSTR lpszFilename)
    {
        qor_pp_fcontext;
        qor_pp_useswinapiAW(gdi32, AddFontResource);
        return Library::Call< int, LPCTSTR >(pFunc, lpszFilename);
    }

    int GDI32::AddFontResourceExT(LPCTSTR lpszFilename, DWORD fl, PVOID pdv)
    {
        qor_pp_fcontext;
        qor_pp_useswinapiAW(gdi32, AddFontResourceEx);
        return Library::Call< int, LPCTSTR, DWORD, PVOID >(pFunc, lpszFilename, fl, pdv);
    }

    int GDI32::AddFontResourceTracking(LPCSTR lpString, int unknown)
    {
        qor_pp_fcontext;
        qor_pp_useswinapi(gdi32, AddFontResourceTracking);
        return Library::Call< int, LPCSTR, int >(pFunc, lpString, unknown);
    }

    HFONT GDI32::CreateFontT(int nHeight, int nWidth, int nEscapement, int nOrientation, int fnWeight, DWORD fdwItalic, DWORD fdwUnderline, DWORD fdwStrikeOut, DWORD fdwCharSet, DWORD fdwOutputPrecision, DWORD fdwClipPrecision, DWORD fdwQuality, DWORD fdwPitchAndFamily, LPCTSTR lpszFace)
    {
        qor_pp_fcontext;
        qor_pp_useswinapiAW(gdi32, CreateFont);
        return Library::Call< HFONT, int, int, int, int, int, DWORD, DWORD, DWORD, DWORD, DWORD, DWORD, DWORD, DWORD, LPCTSTR >(
            pFunc, nHeight, nWidth, nEscapement, nOrientation, fnWeight, fdwItalic, fdwUnderline, fdwStrikeOut, fdwCharSet, fdwOutputPrecision, fdwClipPrecision, fdwQuality, fdwPitchAndFamily, lpszFace);
    }

    HFONT GDI32::CreateFontIndirectT(CONST::LOGFONT* lplf)
    {
        qor_pp_fcontext;
        qor_pp_useswinapiAW(gdi32, CreateFontIndirect);
        return Library::Call< HFONT, CONST ::LOGFONT* >(pFunc, lplf);
    }

    HFONT GDI32::CreateFontIndirectExT(CONST::ENUMLOGFONTEXDV* penumlfex)
    {
        qor_pp_fcontext;
        qor_pp_useswinapiAW(gdi32, CreateFontIndirectEx);
        return Library::Call< HFONT, CONST ::ENUMLOGFONTEXDV* >(pFunc, penumlfex);
    }

    BOOL GDI32::CreateScalableFontResourceT(DWORD fdwHidden, LPCTSTR lpszFontRes, LPCTSTR lpszFontFile, LPCTSTR lpszCurrentPath)
    {
        qor_pp_fcontext;
        qor_pp_useswinapiAW(gdi32, CreateScalableFontResource);
        return Library::Call< BOOL, DWORD, LPCTSTR, LPCTSTR, LPCTSTR >(pFunc, fdwHidden, lpszFontRes, lpszFontFile, lpszCurrentPath);
    }

    BOOL GDI32::EnableEUDC(BOOL fEnableEUDC)
    {
        qor_pp_fcontext;
        qor_pp_useswinapi(gdi32, EnableEUDC);
        return Library::Call< BOOL, BOOL >(pFunc, fEnableEUDC);
    }

    int GDI32::EnumFontFamiliesT(HDC hdc, LPCTSTR lpszFamily, ::FONTENUMPROC lpEnumFontFamProc, LPARAM lParam)
    {
        qor_pp_fcontext;
        qor_pp_useswinapiAW(gdi32, EnumFontFamilies);
        return Library::Call< int, HDC, LPCTSTR, ::FONTENUMPROC, LPARAM >(pFunc, hdc, lpszFamily, lpEnumFontFamProc, lParam);
    }

    int GDI32::EnumFontFamiliesExT(HDC hdc, ::LPLOGFONT lpLogfont, ::FONTENUMPROC lpEnumFontFamExProc, LPARAM lParam, DWORD dwFlags)
    {
        qor_pp_fcontext;
        qor_pp_useswinapiAW(gdi32, EnumFontFamiliesEx);
        return Library::Call< int, HDC, ::LPLOGFONT, ::FONTENUMPROC, LPARAM, DWORD >(pFunc, hdc, lpLogfont, lpEnumFontFamExProc, lParam, dwFlags);
    }

    int GDI32::EnumFontsT(HDC hdc, LPCTSTR lpFaceName, ::FONTENUMPROC lpFontFunc, LPARAM lParam)
    {
        qor_pp_fcontext;
        qor_pp_useswinapiAW(gdi32, EnumFonts);
        return Library::Call< int, HDC, LPCTSTR, ::FONTENUMPROC, LPARAM >(pFunc, hdc, lpFaceName, lpFontFunc, lParam);
    }

    BOOL GDI32::ExtTextOutT(HDC hdc, int X, int Y, UINT fuOptions, CONST::RECT* lprc, LPCTSTR lpString, UINT cbCount, CONST INT* lpDx)
    {
        qor_pp_fcontext;
        qor_pp_useswinapiAW(gdi32, ExtTextOut);
        return Library::Call< BOOL, HDC, int, int, UINT, CONST ::RECT*, LPCTSTR, UINT, CONST INT* >(
            pFunc, hdc, X, Y, fuOptions, lprc, lpString, cbCount, lpDx);
    }

    BOOL GDI32::GetAspectRatioFilterEx(HDC hdc, ::LPSIZE lpAspectRatio)
    {
        qor_pp_fcontext;
        qor_pp_useswinapi(gdi32, GetAspectRatioFilterEx);
        return Library::Call< BOOL, HDC, ::LPSIZE >(pFunc, hdc, lpAspectRatio);
    }

    BOOL GDI32::GetCharABCWidthsT(HDC hdc, UINT uFirstChar, UINT uLastChar, LPABC lpabc)
    {
        qor_pp_fcontext;
        qor_pp_useswinapiAW(gdi32, GetCharABCWidths);
        return Library::Call< BOOL, HDC, UINT, UINT, LPABC >(pFunc, hdc, uFirstChar, uLastChar, lpabc);
    }

    BOOL GDI32::GetCharABCWidthsFloatT(HDC hdc, UINT iFirstChar, UINT iLastChar, ::LPABCFLOAT lpABCF)
    {
        qor_pp_fcontext;
        qor_pp_useswinapiAW(gdi32, GetCharABCWidthsFloat);
        return Library::Call< BOOL, HDC, UINT, UINT, ::LPABCFLOAT >(pFunc, hdc, iFirstChar, iLastChar, lpABCF);
    }

    BOOL GDI32::GetCharABCWidthsI(HDC hdc, UINT giFirst, UINT cgi, LPWORD pgi, LPABC lpabc)
    {
        qor_pp_fcontext;
        qor_pp_useswinapi(gdi32, GetCharABCWidthsI);
        return Library::Call< BOOL, HDC, UINT, UINT, LPWORD, LPABC >(pFunc, hdc, giFirst, cgi, pgi, lpabc);
    }

    DWORD GDI32::GetCharacterPlacementT(HDC hdc, LPCTSTR lpString, int nCount, int nMaxExtent, ::LPGCP_RESULTS lpResults, DWORD dwFlags)
    {
        qor_pp_fcontext;
        qor_pp_useswinapiAW(gdi32, GetCharacterPlacement);
        return Library::Call< DWORD, HDC, LPCTSTR, int, int, ::LPGCP_RESULTS, DWORD >(pFunc, hdc, lpString, nCount, nMaxExtent, lpResults, dwFlags);
    }

    BOOL GDI32::GetCharWidthT(HDC hdc, UINT iFirstChar, UINT iLastChar, LPINT lpBuffer)
    {
        qor_pp_fcontext;
        qor_pp_useswinapiAW(gdi32, GetCharWidth);
        return Library::Call< BOOL, HDC, UINT, UINT, LPINT >(pFunc, hdc, iFirstChar, iLastChar, lpBuffer);
    }

    BOOL GDI32::GetCharWidth32T(HDC hdc, UINT iFirstChar, UINT iLastChar, LPINT lpBuffer)
    {
        qor_pp_fcontext;
        qor_pp_useswinapiAW(gdi32, GetCharWidth32);
        return Library::Call< BOOL, HDC, UINT, UINT, LPINT >(pFunc, hdc, iFirstChar, iLastChar, lpBuffer);
    }

    BOOL GDI32::GetCharWidthFloatT(HDC hdc, UINT iFirstChar, UINT iLastChar, PFLOAT pxBuffer)
    {
        qor_pp_fcontext;
        qor_pp_useswinapiAW(gdi32, GetCharWidthFloat);
        return Library::Call< BOOL, HDC, UINT, UINT, PFLOAT >(pFunc, hdc, iFirstChar, iLastChar, pxBuffer);
    }

    BOOL GDI32::GetCharWidthI(HDC hdc, UINT giFirst, UINT cgi, LPWORD pgi, LPINT lpBuffer)
    {
        qor_pp_fcontext;
        qor_pp_useswinapi(gdi32, GetCharWidthI);
        return Library::Call< BOOL, HDC, UINT, UINT, LPWORD, LPINT >(pFunc, hdc, giFirst, cgi, pgi, lpBuffer);
    }

    DWORD GDI32::GetFontData(HDC hdc, DWORD dwTable, DWORD dwOffset, LPVOID lpvBuffer, DWORD cbData)
    {
        qor_pp_fcontext;
        qor_pp_useswinapi(gdi32, GetFontData);
        return Library::Call< DWORD, HDC, DWORD, DWORD, LPVOID, DWORD >(pFunc, hdc, dwTable, dwOffset, lpvBuffer, cbData);
    }

    DWORD GDI32::GetFontLanguageInfo(HDC hdc)
    {
        qor_pp_fcontext;
        qor_pp_useswinapi(gdi32, GetFontLanguageInfo);
        return Library::Call< DWORD, HDC >(pFunc, hdc);
    }

    DWORD GDI32::GetFontUnicodeRanges(HDC hdc, ::LPGLYPHSET lpgs)
    {
        qor_pp_fcontext;
        qor_pp_useswinapi(gdi32, GetFontUnicodeRanges);
        return Library::Call< DWORD, HDC, ::LPGLYPHSET >(pFunc, hdc, lpgs);
    }

    DWORD GDI32::GetGlyphIndicesT(HDC hdc, LPCTSTR lpstr, int c, LPWORD pgi, DWORD fl)
    {
        qor_pp_fcontext;
        qor_pp_useswinapiAW(gdi32, GetGlyphIndices);
        return Library::Call< DWORD, HDC, LPCTSTR, int, LPWORD, DWORD >(pFunc, hdc, lpstr, c, pgi, fl);
    }

    DWORD GDI32::GetFontResourceInfo(LPCTSTR szFontName, DWORD dwBufSize, LPTSTR szBuffer, DWORD dwInfo)
    {
        qor_pp_fcontext;
        qor_pp_useswinapi(gdi32, GetFontResourceInfo);
        return Library::Call< DWORD, LPCTSTR, DWORD, LPTSTR, DWORD >(pFunc, szFontName, dwBufSize, szBuffer, dwInfo);
    }

    DWORD GDI32::GetGlyphOutlineT(HDC hdc, UINT uChar, UINT uFormat, ::LPGLYPHMETRICS lpgm, DWORD cbBuffer, LPVOID lpvBuffer, CONST::MAT2* lpmat2)
    {
        qor_pp_fcontext;
        qor_pp_useswinapiAW(gdi32, GetGlyphOutline);
        return Library::Call< DWORD, HDC, UINT, UINT, ::LPGLYPHMETRICS, DWORD, LPVOID, CONST::MAT2* >(
            pFunc, hdc, uChar, uFormat, lpgm, cbBuffer, lpvBuffer, lpmat2);
    }

    DWORD GDI32::GetKerningPairsT(HDC hdc, DWORD nNumPairs, ::LPKERNINGPAIR lpkrnpair)
    {
        qor_pp_fcontext;
        qor_pp_useswinapiAW(gdi32, GetKerningPairs);
        return Library::Call< DWORD, HDC, DWORD, ::LPKERNINGPAIR >(pFunc, hdc, nNumPairs, lpkrnpair);
    }

    UINT GDI32::GetOutlineTextMetricsT(HDC hdc, UINT cbData, ::LPOUTLINETEXTMETRIC lpOTM)
    {
        qor_pp_fcontext;
        qor_pp_useswinapiAW(gdi32, GetOutlineTextMetrics);
        return Library::Call< UINT, HDC, UINT, ::LPOUTLINETEXTMETRIC >(pFunc, hdc, cbData, lpOTM);
    }

    BOOL GDI32::GetRasterizerCaps(::LPRASTERIZER_STATUS lprs, UINT cb)
    {
        qor_pp_fcontext;
        qor_pp_useswinapi(gdi32, GetRasterizerCaps);
        return Library::Call< BOOL, ::LPRASTERIZER_STATUS, UINT >(pFunc, lprs, cb);
    }

    UINT GDI32::GetTextAlign(HDC hdc)
    {
        qor_pp_fcontext;
        qor_pp_useswinapi(gdi32, GetTextAlign);
        return Library::Call< UINT, HDC >(pFunc, hdc);
    }

    int GDI32::GetTextCharacterExtra(HDC hdc)
    {
        qor_pp_fcontext;
        qor_pp_useswinapi(gdi32, GetTextCharacterExtra);
        return Library::Call< int, HDC >(pFunc, hdc);
    }

    int GDI32::GetTextCharset(HDC hdc)
    {
        qor_pp_fcontext;
        qor_pp_useswinapi(gdi32, GetTextCharset);
        return Library::Call< int, HDC >(pFunc, hdc);
    }

    int GDI32::GetTextCharsetInfo(HDC hdc, ::LPFONTSIGNATURE lpSig, DWORD dwFlags)
    {
        qor_pp_fcontext;
        qor_pp_useswinapi(gdi32, GetTextCharsetInfo);
        return Library::Call< int, HDC, ::LPFONTSIGNATURE, DWORD >(pFunc, hdc, lpSig, dwFlags);
    }

    COLORREF GDI32::GetTextColor(HDC hdc)
    {
        qor_pp_fcontext;
        qor_pp_useswinapi(gdi32, GetTextColor);
        return Library::Call< COLORREF, HDC >(pFunc, hdc);
    }

    BOOL GDI32::GetTextExtentExPointT(HDC hdc, LPCTSTR lpszStr, int cchString, int nMaxExtent, LPINT lpnFit, LPINT alpDx, ::LPSIZE lpSize)
    {
        qor_pp_fcontext;
        qor_pp_useswinapiAW(gdi32, GetTextExtentExPoint);
        return Library::Call< BOOL, HDC, LPCTSTR, int, int, LPINT, LPINT, ::LPSIZE >(pFunc, hdc, lpszStr, cchString, nMaxExtent, lpnFit, alpDx, lpSize);
    }

    BOOL GDI32::GetTextExtentExPointI(HDC hdc, LPWORD pgiIn, int cgi, int nMaxExtent, LPINT lpnFit, LPINT alpDx, ::LPSIZE lpSize)
    {
        qor_pp_fcontext;
        qor_pp_useswinapi(gdi32, GetTextExtentExPointI);
        return Library::Call< BOOL, HDC, LPWORD, int, int, LPINT, LPINT, ::LPSIZE >(
            pFunc, hdc, pgiIn, cgi, nMaxExtent, lpnFit, alpDx, lpSize);
    }

    BOOL GDI32::GetTextExtentPointT(HDC hdc, LPCTSTR lpString, int cbString, ::LPSIZE lpSize)
    {
        qor_pp_fcontext;
        qor_pp_useswinapiAW(gdi32, GetTextExtentPoint);
        return Library::Call< BOOL, HDC, LPCTSTR, int, ::LPSIZE >(pFunc, hdc, lpString, cbString, lpSize);
    }

    BOOL GDI32::GetTextExtentPoint32T(HDC hdc, LPCTSTR lpString, int c, ::LPSIZE lpSize)
    {
        qor_pp_fcontext;
        qor_pp_useswinapiAW(gdi32, GetTextExtentPoint32);
        return Library::Call< BOOL, HDC, LPCTSTR, int, ::LPSIZE >(pFunc, hdc, lpString, c, lpSize);
    }

    BOOL GDI32::GetTextExtentPointI(HDC hdc, LPWORD pgiIn, int cgi, ::LPSIZE lpSize)
    {
        qor_pp_fcontext;
        qor_pp_useswinapi(gdi32, GetTextExtentPointI);
        return Library::Call< BOOL, HDC, LPWORD, int, ::LPSIZE >(pFunc, hdc, pgiIn, cgi, lpSize);
    }

    int GDI32::GetTextFaceT(HDC hdc, int nCount, LPTSTR lpFaceName)
    {
        qor_pp_fcontext;
        qor_pp_useswinapiAW(gdi32, GetTextFace);
        return Library::Call< int, HDC, int, LPTSTR >(pFunc, hdc, nCount, lpFaceName);
    }

    BOOL GDI32::GetTextMetricsT(HDC hdc, ::LPTEXTMETRIC lptm)
    {
        qor_pp_fcontext;
        qor_pp_useswinapiAW(gdi32, GetTextMetrics);
        return Library::Call< BOOL, HDC, ::LPTEXTMETRIC >(pFunc, hdc, lptm);
    }

    BOOL GDI32::PolyTextOutT(HDC hdc, CONST::POLYTEXT* pptxt, int cStrings)
    {
        qor_pp_fcontext;
        qor_pp_useswinapiAW(gdi32, PolyTextOut);
        return Library::Call< BOOL, HDC, CONST ::POLYTEXT*, int >(pFunc, hdc, pptxt, cStrings);
    }

    BOOL GDI32::RemoveFontMemResourceEx(HANDLE fh)
    {
        qor_pp_fcontext;
        qor_pp_useswinapi(gdi32, RemoveFontMemResourceEx);
        return Library::Call< BOOL, HANDLE >(pFunc, fh);
    }

    BOOL GDI32::RemoveFontResourceT(LPCTSTR lpFileName)
    {
        qor_pp_fcontext;
        qor_pp_useswinapiAW(gdi32, RemoveFontResource);
        return Library::Call< BOOL, LPCTSTR >(pFunc, lpFileName);
    }

    BOOL GDI32::RemoveFontResourceExT(LPCTSTR lpFileName, DWORD fl, PVOID pdv)
    {
        qor_pp_fcontext;
        qor_pp_useswinapiAW(gdi32, RemoveFontResourceEx);
        return Library::Call< BOOL, LPCTSTR, DWORD, PVOID >(pFunc, lpFileName, fl, pdv);
    }

    DWORD GDI32::SetMapperFlags(HDC hdc, DWORD dwFlag)
    {
        qor_pp_fcontext;
        qor_pp_useswinapi(gdi32, SetMapperFlags);
        return Library::Call< DWORD, HDC, DWORD >(pFunc, hdc, dwFlag);
    }

    UINT GDI32::SetTextAlign(HDC hdc, UINT fMode)
    {
        qor_pp_fcontext;
        qor_pp_useswinapi(gdi32, SetTextAlign);
        return Library::Call< UINT, HDC, UINT >(pFunc, hdc, fMode);
    }

    int GDI32::SetTextCharacterExtra(HDC hdc, int nCharExtra)
    {
        qor_pp_fcontext;
        qor_pp_useswinapi(gdi32, SetTextCharacterExtra);
        return Library::Call< int, HDC, int  >(pFunc, hdc, nCharExtra);
    }

    COLORREF GDI32::SetTextColor(HDC hdc, COLORREF crColor)
    {
        qor_pp_fcontext;
        qor_pp_useswinapi(gdi32, SetTextColor);
        return Library::Call< COLORREF, HDC, COLORREF >(pFunc, hdc, crColor);
    }

    BOOL GDI32::SetTextJustification(HDC hdc, int nBreakExtra, int nBreakCount)
    {
        qor_pp_fcontext;
        qor_pp_useswinapi(gdi32, SetTextJustification);
        return Library::Call< BOOL, HDC, int, int >(pFunc, hdc, nBreakExtra, nBreakCount);
    }

    BOOL GDI32::TextOutT(HDC hdc, int nXStart, int nYStart, LPCTSTR lpString, int cbString)
    {
        qor_pp_fcontext;
        qor_pp_useswinapiAW(gdi32, TextOut);
        return Library::Call< BOOL, HDC, int, int, LPCTSTR, int >(pFunc, hdc, nXStart, nYStart, lpString, cbString);
    }

    BOOL GDI32::TranslateCharsetInfo(DWORD* pSrc, LPCHARSETINFO lpCs, DWORD dwFlags)
    {
        qor_pp_fcontext;
        qor_pp_useswinapi(gdi32, TranslateCharsetInfo);
        return Library::Call< BOOL, DWORD*, LPCHARSETINFO, DWORD >(pFunc, pSrc, lpCs, dwFlags);
    }

}}}//qor:nswindows::api