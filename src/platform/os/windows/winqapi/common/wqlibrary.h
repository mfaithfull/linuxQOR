// Copyright Querysoft Limited 2008 - 2025
//
// Permission is hereby granted, free of charge, to any person or organization
// obtaining a copy of the software and accompanying documentation covered by
// this license (the "Software") to use, reproduce, display, distribute,
// execute, and transmit the Software, and to prepare derivative works of the
// Software, and to permit third-parties to whom the Software is furnished to
// do so, all subject to the following:
// 
// The copyright notices in the Software and this entire statement, including
// the above license grant, this restriction and the following disclaimer,
// must be included in all copies of the Software, in whole or in part, and
// all derivative works of the Software, unless such copies or derivative
// works are solely in the form of machine-executable object code generated by
// a source language processor.
// 
// THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
// IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
// FITNESS FOR A PARTICULAR PURPOSE, TITLE AND NON-INFRINGEMENT. IN NO EVENT
// SHALL THE COPYRIGHT HOLDERS OR ANYONE DISTRIBUTING THE SOFTWARE BE LIABLE
// FOR ANY DAMAGES OR OTHER LIABILITY, WHETHER IN CONTRACT, TORT OR OTHERWISE,
// ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER
// DEALINGS IN THE SOFTWARE.

namespace qor { namespace winapi {

	//------------------------------------------------------------------------------
	class qor_pp_module_interface(QOR_WINAPI) Library
	{
	public:

		typedef int(*DefProc)(void);//Default procedure pointer type

		//------------------------------------------------------------------------------
		template< typename ret, class ...MethodArgs >
		static ret Call(const DefProc pProc, MethodArgs... args)
		{
			typedef ret(*fPtr)(MethodArgs...);

			fPtr FP = reinterpret_cast<fPtr>(pProc);

			if (FP != nullptr)
			{
				return (FP)(std::forward< MethodArgs >(args)...);
			}
			else
			{
				serious("Missing library function.");
			}
		}
		/*
		//------------------------------------------------------------------------------
		static void voidCallvoid(const DefProc pProc)
		{
			typedef void(qor_pp_compiler_stdcallconvention* fPtr)(void);

			fPtr FP = reinterpret_cast<fPtr>(pProc);

			if (FP != 0)
			{
				(FP)();
			}
			else
			{
				//nsCodeQOR::CError::Raise(winqapi::MISSING_LIBRARY_FUNCTION, winqapi::ErrorDomainPtr(), nsCodeQOR::CError::ERR_LVL_CONTINUE);
			}
		}

		//------------------------------------------------------------------------------
		template< typename param1 >
		static void voidCall(const DefProc pProc, param1 P1)
		{
			typedef void(qor_pp_compiler_stdcallconvention* fPtr)(param1);

			fPtr FP = reinterpret_cast<fPtr>(pProc);

			if (FP != 0)
			{
				(FP)(P1);
			}
			else
			{
				//nsCodeQOR::CError::Raise(winqapi::MISSING_LIBRARY_FUNCTION, winqapi::ErrorDomainPtr(), nsCodeQOR::CError::ERR_LVL_CONTINUE);
			}
		}

		//------------------------------------------------------------------------------
		template< typename ret, typename param1 >
		static ret Call(const DefProc pProc, param1 P1)
		{
			typedef ret(qor_pp_compiler_stdcallconvention* fPtr)(param1);

			fPtr FP = reinterpret_cast<fPtr>(pProc);

			if (FP != 0)
			{
				return (FP)(P1);
			}

			//nsCodeQOR::CError::Raise(winqapi::MISSING_LIBRARY_FUNCTION, winqapi::ErrorDomainPtr(), nsCodeQOR::CError::ERR_LVL_CONTINUE);

			ret R1;
			return R1;
		}

		//------------------------------------------------------------------------------
		template< typename param1, typename param2 >
		static void voidCall(const DefProc pProc, param1 P1, param2 P2)
		{
			typedef void(qor_pp_compiler_stdcallconvention* fPtr)(param1, param2);

			fPtr FP = reinterpret_cast<fPtr>(pProc);

			if (FP != 0)
			{
				(FP)(P1, P2);
			}
			else
			{
				//nsCodeQOR::CError::Raise(winqapi::MISSING_LIBRARY_FUNCTION, winqapi::ErrorDomainPtr(), nsCodeQOR::CError::ERR_LVL_CONTINUE);
			}
		}

		//------------------------------------------------------------------------------
		template< typename ret, typename param1, typename param2 >
		static ret Call(const DefProc pProc, param1 P1, param2 P2)
		{
			typedef ret(qor_pp_compiler_stdcallconvention* fPtr)(param1, param2);

			fPtr FP = reinterpret_cast<fPtr>(pProc);

			if (FP != 0)
			{
				return (FP)(P1, P2);
			}

			//nsCodeQOR::CError::Raise(winqapi::MISSING_LIBRARY_FUNCTION, winqapi::ErrorDomainPtr(), nsCodeQOR::CError::ERR_LVL_CONTINUE);

			ret R1;
			return R1;
		}

		//------------------------------------------------------------------------------
		template< typename param1, typename param2, typename param3 >
		static void voidCall(const DefProc pProc, param1 P1, param2 P2, param3 P3)
		{
			typedef void(qor_pp_compiler_stdcallconvention* fPtr)(param1, param2, param3);

			fPtr FP = reinterpret_cast<fPtr>(pProc);

			if (FP != 0)
			{
				(FP)(P1, P2, P3);
			}
			else
			{
				//nsCodeQOR::CError::Raise(winqapi::MISSING_LIBRARY_FUNCTION, winqapi::ErrorDomainPtr(), nsCodeQOR::CError::ERR_LVL_CONTINUE);
			}
		}

		//------------------------------------------------------------------------------
		template< typename ret, typename param1, typename param2, typename param3 >
		static ret Call(const DefProc pProc, param1 P1, param2 P2, param3 P3)
		{
			typedef ret(qor_pp_compiler_stdcallconvention* fPtr)(param1, param2, param3);

			fPtr FP = reinterpret_cast<fPtr>(pProc);

			if (FP != 0)
			{
				return (FP)(P1, P2, P3);
			}

			//nsCodeQOR::CError::Raise(winqapi::MISSING_LIBRARY_FUNCTION, winqapi::ErrorDomainPtr(), nsCodeQOR::CError::ERR_LVL_CONTINUE);

			ret R1;
			return R1;
		}

		//------------------------------------------------------------------------------
		template< typename param1, typename param2, typename param3, typename param4 >
		static void voidCall(const DefProc pProc, param1 P1, param2 P2, param3 P3, param4 P4)
		{
			typedef void(qor_pp_compiler_stdcallconvention* fPtr)(param1, param2, param3, param4);

			fPtr FP = reinterpret_cast<fPtr>(pProc);

			if (FP != 0)
			{
				(FP)(P1, P2, P3, P4);
			}
			else
			{
				//nsCodeQOR::CError::Raise(winqapi::MISSING_LIBRARY_FUNCTION, winqapi::ErrorDomainPtr(), nsCodeQOR::CError::ERR_LVL_CONTINUE);
			}
		}

		//------------------------------------------------------------------------------
		template< typename ret, typename param1, typename param2, typename param3, typename param4 >
		static ret Call(const DefProc pProc, param1 P1, param2 P2, param3 P3, param4 P4)
		{
			typedef ret(qor_pp_compiler_stdcallconvention* fPtr)(param1, param2, param3, param4);

			fPtr FP = reinterpret_cast<fPtr>(pProc);

			if (FP != 0)
			{
				return (FP)(P1, P2, P3, P4);
			}

			//nsCodeQOR::CError::Raise(winqapi::MISSING_LIBRARY_FUNCTION, winqapi::ErrorDomainPtr(), nsCodeQOR::CError::ERR_LVL_CONTINUE);

			ret R1;
			return R1;
		}

		//------------------------------------------------------------------------------
		template< typename param1, typename param2, typename param3, typename param4, typename param5 >
		static void voidCall(const DefProc pProc, param1 P1, param2 P2, param3 P3, param4 P4, param5 P5)
		{
			typedef void(qor_pp_compiler_stdcallconvention* fPtr)(param1, param2, param3, param4, param5);

			fPtr FP = reinterpret_cast<fPtr>(pProc);

			if (FP != 0)
			{
				(FP)(P1, P2, P3, P4, P5);
			}
			else
			{
				//nsCodeQOR::CError::Raise(winqapi::MISSING_LIBRARY_FUNCTION, winqapi::ErrorDomainPtr(), nsCodeQOR::CError::ERR_LVL_CONTINUE);
			}
		}

		//------------------------------------------------------------------------------
		template< typename ret, typename param1, typename param2, typename param3, typename param4, typename param5 >
		static ret Call(const DefProc pProc, param1 P1, param2 P2, param3 P3, param4 P4, param5 P5)
		{
			typedef ret(qor_pp_compiler_stdcallconvention* fPtr)(param1, param2, param3, param4, param5);

			fPtr FP = reinterpret_cast<fPtr>(pProc);

			if (FP != 0)
			{
				return (FP)(P1, P2, P3, P4, P5);
			}

			//nsCodeQOR::CError::Raise(winqapi::MISSING_LIBRARY_FUNCTION, winqapi::ErrorDomainPtr(), nsCodeQOR::CError::ERR_LVL_CONTINUE);

			ret R1;
			return R1;
		}

		//------------------------------------------------------------------------------
		template< typename param1, typename param2, typename param3, typename param4, typename param5, typename param6 >
		static void voidCall(const DefProc pProc, param1 P1, param2 P2, param3 P3, param4 P4, param5 P5, param6 P6)
		{
			typedef void(qor_pp_compiler_stdcallconvention* fPtr)(param1, param2, param3, param4, param5, param6);

			fPtr FP = reinterpret_cast<fPtr>(pProc);

			if (FP != 0)
			{
				(FP)(P1, P2, P3, P4, P5, P6);
			}
			else
			{
				//nsCodeQOR::CError::Raise(winqapi::MISSING_LIBRARY_FUNCTION, winqapi::ErrorDomainPtr(), nsCodeQOR::CError::ERR_LVL_CONTINUE);
			}
		}

		//------------------------------------------------------------------------------
		template< typename ret, typename param1, typename param2, typename param3, typename param4, typename param5, typename param6 >
		static ret Call(const DefProc pProc, param1 P1, param2 P2, param3 P3, param4 P4, param5 P5, param6 P6)
		{
			typedef ret(qor_pp_compiler_stdcallconvention* fPtr)(param1, param2, param3, param4, param5, param6);

			fPtr FP = reinterpret_cast<fPtr>(pProc);

			if (FP != 0)
			{
				return (FP)(P1, P2, P3, P4, P5, P6);
			}

			//nsCodeQOR::CError::Raise(winqapi::MISSING_LIBRARY_FUNCTION, winqapi::ErrorDomainPtr(), nsCodeQOR::CError::ERR_LVL_CONTINUE);

			ret R1;
			return R1;
		}

		//------------------------------------------------------------------------------
		template< typename param1, typename param2, typename param3, typename param4, typename param5, typename param6, typename param7 >
		static void voidCall(const DefProc pProc, param1 P1, param2 P2, param3 P3, param4 P4, param5 P5, param6 P6, param7 P7)
		{
			typedef void(qor_pp_compiler_stdcallconvention* fPtr)(param1, param2, param3, param4, param5, param6, param7);

			fPtr FP = reinterpret_cast<fPtr>(pProc);

			if (FP != 0)
			{
				(FP)(P1, P2, P3, P4, P5, P6, P7);
			}
			else
			{
				//nsCodeQOR::CError::Raise(winqapi::MISSING_LIBRARY_FUNCTION, winqapi::ErrorDomainPtr(), nsCodeQOR::CError::ERR_LVL_CONTINUE);
			}
		}

		//------------------------------------------------------------------------------
		template< typename ret, typename param1, typename param2, typename param3, typename param4, typename param5, typename param6, typename param7 >
		static ret Call(const DefProc pProc, param1 P1, param2 P2, param3 P3, param4 P4, param5 P5, param6 P6, param7 P7)
		{
			typedef ret(qor_pp_compiler_stdcallconvention* fPtr)(param1, param2, param3, param4, param5, param6, param7);

			fPtr FP = reinterpret_cast<fPtr>(pProc);

			if (FP != 0)
			{
				return (FP)(P1, P2, P3, P4, P5, P6, P7);
			}

			//nsCodeQOR::CError::Raise(winqapi::MISSING_LIBRARY_FUNCTION, winqapi::ErrorDomainPtr(), nsCodeQOR::CError::ERR_LVL_CONTINUE);

			ret R1;
			return R1;
		}

		//------------------------------------------------------------------------------
		template< typename ret, typename param1, typename param2, typename param3, typename param4, typename param5, typename param6, typename param7, typename param8 >
		static ret Call(const DefProc pProc, param1 P1, param2 P2, param3 P3, param4 P4, param5 P5, param6 P6, param7 P7, param8 P8)
		{
			typedef ret(qor_pp_compiler_stdcallconvention* fPtr)(param1, param2, param3, param4, param5, param6, param7, param8);

			fPtr FP = reinterpret_cast<fPtr>(pProc);

			if (FP != 0)
			{
				return (FP)(P1, P2, P3, P4, P5, P6, P7, P8);
			}

			//nsCodeQOR::CError::Raise(winqapi::MISSING_LIBRARY_FUNCTION, winqapi::ErrorDomainPtr(), nsCodeQOR::CError::ERR_LVL_CONTINUE);

			ret R1;
			return R1;
		}

		//------------------------------------------------------------------------------
		template< typename ret, typename param1, typename param2, typename param3, typename param4, typename param5, typename param6, typename param7, typename param8, typename param9 >
		static ret Call(const DefProc pProc, param1 P1, param2 P2, param3 P3, param4 P4, param5 P5, param6 P6, param7 P7, param8 P8, param9 P9)
		{
			typedef ret(qor_pp_compiler_stdcallconvention* fPtr)(param1, param2, param3, param4, param5, param6, param7, param8, param9);

			fPtr FP = reinterpret_cast<fPtr>(pProc);

			if (FP != 0)
			{
				return (FP)(P1, P2, P3, P4, P5, P6, P7, P8, P9);
			}

			//nsCodeQOR::CError::Raise(winqapi::MISSING_LIBRARY_FUNCTION, winqapi::ErrorDomainPtr(), nsCodeQOR::CError::ERR_LVL_CONTINUE);

			ret R1;
			return R1;
		}

		//------------------------------------------------------------------------------
		template< typename ret, typename param1, typename param2, typename param3, typename param4, typename param5, typename param6, typename param7, typename param8, typename param9, typename param10 >
		static ret Call(const DefProc pProc, param1 P1, param2 P2, param3 P3, param4 P4, param5 P5, param6 P6, param7 P7, param8 P8, param9 P9, param10 P10)
		{
			typedef ret(qor_pp_compiler_stdcallconvention* fPtr)(param1, param2, param3, param4, param5, param6, param7, param8, param9, param10);

			fPtr FP = reinterpret_cast<fPtr>(pProc);

			if (FP != 0)
			{
				return (FP)(P1, P2, P3, P4, P5, P6, P7, P8, P9, P10);
			}

			//nsCodeQOR::CError::Raise(winqapi::MISSING_LIBRARY_FUNCTION, winqapi::ErrorDomainPtr(), nsCodeQOR::CError::ERR_LVL_CONTINUE);

			ret R1;
			return R1;
		}

		//------------------------------------------------------------------------------
		template< typename ret, typename param1, typename param2, typename param3, typename param4, typename param5, typename param6, typename param7, typename param8, typename param9, typename param10, typename param11 >
		static ret Call(const DefProc pProc, param1 P1, param2 P2, param3 P3, param4 P4, param5 P5, param6 P6, param7 P7, param8 P8, param9 P9, param10 P10, param11 P11)
		{
			typedef ret(qor_pp_compiler_stdcallconvention* fPtr)(param1, param2, param3, param4, param5, param6, param7, param8, param9, param10, param11);

			fPtr FP = reinterpret_cast<fPtr>(pProc);

			if (FP != 0)
			{
				return (FP)(P1, P2, P3, P4, P5, P6, P7, P8, P9, P10, P11);
			}

			//nsCodeQOR::CError::Raise(winqapi::MISSING_LIBRARY_FUNCTION, winqapi::ErrorDomainPtr(), nsCodeQOR::CError::ERR_LVL_CONTINUE);

			ret R1;
			return R1;
		}

		//------------------------------------------------------------------------------
		template< typename ret, typename param1, typename param2, typename param3, typename param4, typename param5, typename param6, typename param7, typename param8, typename param9, typename param10, typename param11, typename param12 >
		static ret Call(const DefProc pProc, param1 P1, param2 P2, param3 P3, param4 P4, param5 P5, param6 P6, param7 P7, param8 P8, param9 P9, param10 P10, param11 P11, param12 P12)
		{
			typedef ret(qor_pp_compiler_stdcallconvention* fPtr)(param1, param2, param3, param4, param5, param6, param7, param8, param9, param10, param11, param12);

			fPtr FP = reinterpret_cast<fPtr>(pProc);

			if (FP != 0)
			{
				return (FP)(P1, P2, P3, P4, P5, P6, P7, P8, P9, P10, P11, P12);
			}

			//nsCodeQOR::CError::Raise(winqapi::MISSING_LIBRARY_FUNCTION, winqapi::ErrorDomainPtr(), nsCodeQOR::CError::ERR_LVL_CONTINUE);

			ret R1;
			return R1;
		}

		//------------------------------------------------------------------------------
		template< typename ret, typename param1, typename param2, typename param3, typename param4, typename param5, typename param6, typename param7, typename param8, typename param9, typename param10, typename param11, typename param12, typename param13 >
		static ret Call(const DefProc pProc, param1 P1, param2 P2, param3 P3, param4 P4, param5 P5, param6 P6, param7 P7, param8 P8, param9 P9, param10 P10, param11 P11, param12 P12, param13 P13)
		{
			typedef ret(qor_pp_compiler_stdcallconvention* fPtr)(param1, param2, param3, param4, param5, param6, param7, param8, param9, param10, param11, param12, param13);

			fPtr FP = reinterpret_cast<fPtr>(pProc);

			if (FP != 0)
			{
				return (FP)(P1, P2, P3, P4, P5, P6, P7, P8, P9, P10, P11, P12, P13);
			}

			//nsCodeQOR::CError::Raise(winqapi::MISSING_LIBRARY_FUNCTION, winqapi::ErrorDomainPtr(), nsCodeQOR::CError::ERR_LVL_CONTINUE);

			ret R1;
			return R1;
		}

		//------------------------------------------------------------------------------
		template< typename ret, typename param1, typename param2, typename param3, typename param4, typename param5, typename param6, typename param7, typename param8, typename param9, typename param10, typename param11, typename param12, typename param13, typename param14 >
		static ret Call(const DefProc pProc, param1 P1, param2 P2, param3 P3, param4 P4, param5 P5, param6 P6, param7 P7, param8 P8, param9 P9, param10 P10, param11 P11, param12 P12, param13 P13, param14 P14)
		{
			typedef ret(qor_pp_compiler_stdcallconvention* fPtr)(param1, param2, param3, param4, param5, param6, param7, param8, param9, param10, param11, param12, param13, param14);

			fPtr FP = reinterpret_cast<fPtr>(pProc);

			if (FP != 0)
			{
				return (FP)(P1, P2, P3, P4, P5, P6, P7, P8, P9, P10, P11, P12, P13, P14);
			}

			//nsCodeQOR::CError::Raise(winqapi::MISSING_LIBRARY_FUNCTION, winqapi::ErrorDomainPtr(), nsCodeQOR::CError::ERR_LVL_CONTINUE);

			ret R1;
			return R1;
		}

		//------------------------------------------------------------------------------
		template< typename ret, typename param1, typename param2, typename param3, typename param4, typename param5, typename param6, typename param7, typename param8, typename param9, typename param10, typename param11, typename param12, typename param13, typename param14, typename param15 >
		static ret Call(const DefProc pProc, param1 P1, param2 P2, param3 P3, param4 P4, param5 P5, param6 P6, param7 P7, param8 P8, param9 P9, param10 P10, param11 P11, param12 P12, param13 P13, param14 P14, param15 P15)
		{
			typedef ret(qor_pp_compiler_stdcallconvention* fPtr)(param1, param2, param3, param4, param5, param6, param7, param8, param9, param10, param11, param12, param13, param14, param15);

			fPtr FP = reinterpret_cast<fPtr>(pProc);

			if (FP != 0)
			{
				return (FP)(P1, P2, P3, P4, P5, P6, P7, P8, P9, P10, P11, P12, P13, P14, P15);
			}

			//nsCodeQOR::CError::Raise(winqapi::MISSING_LIBRARY_FUNCTION, winqapi::ErrorDomainPtr(), nsCodeQOR::CError::ERR_LVL_CONTINUE);

			ret R1;
			return R1;
		}

		//------------------------------------------------------------------------------
		template< typename ret, typename param1, typename param2, typename param3, typename param4, typename param5, typename param6, typename param7, typename param8, typename param9, typename param10, typename param11, typename param12, typename param13, typename param14, typename param15, typename param16 >
		static ret Call(const DefProc pProc, param1 P1, param2 P2, param3 P3, param4 P4, param5 P5, param6 P6, param7 P7, param8 P8, param9 P9, param10 P10, param11 P11, param12 P12, param13 P13, param14 P14, param15 P15, param16 P16)
		{
			typedef ret(qor_pp_compiler_stdcallconvention* fPtr)(param1, param2, param3, param4, param5, param6, param7, param8, param9, param10, param11, param12, param13, param14, param15, param16);

			fPtr FP = reinterpret_cast<fPtr>(pProc);

			if (FP != 0)
			{
				return (FP)(P1, P2, P3, P4, P5, P6, P7, P8, P9, P10, P11, P12, P13, P14, P15, P16);
			}

			//nsCodeQOR::CError::Raise(winqapi::MISSING_LIBRARY_FUNCTION, winqapi::ErrorDomainPtr(), nsCodeQOR::CError::ERR_LVL_CONTINUE);

			ret R1;
			return R1;
		}

		//------------------------------------------------------------------------------
		template< typename ret, typename param1, typename param2, typename param3, typename param4, typename param5, typename param6, typename param7, typename param8, typename param9, typename param10, typename param11, typename param12, typename param13, typename param14, typename param15, typename param16, typename param17  >
		static ret Call(const DefProc pProc, param1 P1, param2 P2, param3 P3, param4 P4, param5 P5, param6 P6, param7 P7, param8 P8, param9 P9, param10 P10, param11 P11, param12 P12, param13 P13, param14 P14, param15 P15, param16 P16, param17 P17)
		{
			typedef ret(qor_pp_compiler_stdcallconvention* fPtr)(param1, param2, param3, param4, param5, param6, param7, param8, param9, param10, param11, param12, param13, param14, param15, param16, param17);

			fPtr FP = reinterpret_cast<fPtr>(pProc);

			if (FP != 0)
			{
				return (FP)(P1, P2, P3, P4, P5, P6, P7, P8, P9, P10, P11, P12, P13, P14, P15, P16, P17);
			}

			//nsCodeQOR::CError::Raise(winqapi::MISSING_LIBRARY_FUNCTION, winqapi::ErrorDomainPtr(), nsCodeQOR::CError::ERR_LVL_CONTINUE);

			ret R1;
			return R1;
		}
		*/
	};

}}//qor::winapi